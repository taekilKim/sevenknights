<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title id="dynamic-title">ì˜ì›… ìƒì„¸ - ì„¸ë‚˜DB</title>
  <!-- SEO Meta Tags for Hero Detail Page -->
  <meta id="meta-description" name="description" content="ì„¸ë‚˜DB - ì„¸ë¸ë‚˜ì´ì¸  ë¦¬ë²„ìŠ¤ ì˜ì›… ìƒì„¸ í˜ì´ì§€" />
  <meta id="meta-keywords" name="keywords" content="ì„¸ë‚˜DB, ì„¸ë‚˜db, ì„¸ë‚˜ ë¦¬ë²„ìŠ¤, ì„¸ë¸ë‚˜ì´ì¸  ë¦¬ë²„ìŠ¤, ì˜ì›…, ìƒì„¸, ë„ê°, Seven Knights, Hero, Detail" />
  <meta name="author" content="ì„¸ë‚˜DB" />
  <!-- Open Graph Meta Tags -->
  <meta property="og:site_name" content="ì„¸ë‚˜DB" />
  <meta id="og-title" property="og:title" content="ì˜ì›… ìƒì„¸ - ì„¸ë‚˜DB" />
  <meta id="og-description" property="og:description" content="ì„¸ë‚˜DB - ì„¸ë¸ë‚˜ì´ì¸  ë¦¬ë²„ìŠ¤ ì˜ì›…ì˜ ìƒì„¸ ì •ë³´ë¥¼ í™•ì¸í•˜ì„¸ìš”." />
  <meta id="og-image" property="og:image" content="/default-hero-og-image.png" />
  <meta id="og-url" property="og:url" content="https://senadb.games/hero.html" />
  <meta property="og:type" content="article" />
  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta id="twitter-title" name="twitter:title" content="ì˜ì›… ìƒì„¸ - ì„¸ë‚˜DB" />
  <meta id="twitter-description" name="twitter:description" content="ì„¸ë‚˜DB - ì„¸ë¸ë‚˜ì´ì¸  ë¦¬ë²„ìŠ¤ ì˜ì›…ì˜ ìƒì„¸ ì •ë³´ë¥¼ í™•ì¸í•˜ì„¸ìš”." />
  <meta id="twitter-image" name="twitter:image" content="/default-hero-og-image.png" />
  <!-- Canonical Link -->
  <link id="canonical-link" rel="canonical" href="https://senadb.games/hero.html" />
  <meta name="robots" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1">
  <meta name="googlebot" content="index, follow">
  <meta name="naverbot" content="index, follow">
  <meta name="subject" content="ì„¸ë¸ë‚˜ì´ì¸  ë¦¬ë²„ìŠ¤ ì˜ì›… ìƒì„¸ ì •ë³´, ìŠ¤í‚¬, ëŠ¥ë ¥ì¹˜, ì†Œì†">
  <meta name="rating" content="general">
  <meta name="distribution" content="global">
  <meta name="theme-color" content="#181818">
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7293515082092840"
     crossorigin="anonymous"></script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "VideoGameCharacter",
  "name": "ì„¸ë¸ë‚˜ì´ì¸  ë¦¬ë²„ìŠ¤ ì˜ì›…",
  "url": "https://senadb.games/hero.html",
  "description": "ì„¸ë‚˜DB - ì„¸ë¸ë‚˜ì´ì¸  ë¦¬ë²„ìŠ¤ ì˜ì›…ì˜ ìŠ¤íƒ¯, ìŠ¤í‚¬, ì†Œì† ë° í¬ê·€ë„ ìƒì„¸ ì •ë³´ í˜ì´ì§€ì…ë‹ˆë‹¤.",
  "inLanguage": "ko",
  "isPartOf": {
    "@type": "VideoGame",
    "name": "ì„¸ë¸ë‚˜ì´ì¸  ë¦¬ë²„ìŠ¤ (Seven Knights Re:birth)"
  }
}
</script>
  <link rel="stylesheet" href="./style.css" />
  <script src="https://cdn.jsdelivr.net/npm/@phosphor-icons/web@2.1.2"></script>
  <!-- Google tag (gtag.js) - Only on production -->
  <script>
    // Only load analytics on production domain and not in developer mode
    // To enable developer mode (exclude your traffic):
    //   Console: localStorage.setItem('devMode', 'true')
    // To disable developer mode:
    //   Console: localStorage.removeItem('devMode')
    var isProduction = window.location.hostname === 'senadb.games';
    var isDeveloperMode = localStorage.getItem('devMode') === 'true';

    if (isProduction && !isDeveloperMode) {
      // Load gtag.js
      var gtagScript = document.createElement('script');
      gtagScript.async = true;
      gtagScript.src = 'https://www.googletagmanager.com/gtag/js?id=G-DMD8LXSEQ5';
      document.head.appendChild(gtagScript);

      // Initialize GA with hero-specific tracking
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      // Dynamically extract hero name for analytics
      const analyticsParams = new URLSearchParams(window.location.search);
      const heroNameForAnalytics = analyticsParams.get("name") || "unknown";
      gtag('config', 'G-DMD8LXSEQ5', {
        'page_title': `Hero Detail - ${heroNameForAnalytics}`,
        'page_path': `/hero/${encodeURIComponent(heroNameForAnalytics)}`
      });
    } else if (isDeveloperMode) {
      console.log('Developer mode enabled - Analytics disabled');
    }
  </script>
</head>
<body>
  <script>
    // ì „ì—­ì—ì„œ ì ‘ê·¼ ê°€ëŠ¥í•œ heroId
    const globalParams = new URLSearchParams(window.location.search);
    window.heroId = globalParams.get("name") ? decodeURIComponent(globalParams.get("name")) : null;
  </script>
  <div class="app-container">
    <!-- HeaderëŠ” /js/header.jsì—ì„œ ë™ì ìœ¼ë¡œ ìƒì„±ë©ë‹ˆë‹¤ -->

    <!-- Desktop Navigation Sidebar -->
    <aside class="desktop-nav">
      <nav>
        <a href="/index.html" class="nav-link">
          <i class="ph-bold ph-users-three"></i>
          <span>ì˜ì›… ë„ê°</span>
        </a>
        <a href="/deck.html" class="nav-link">
          <i class="ph-bold ph-sword"></i>
          <span>ê²°íˆ¬ì¥ ë±</span>
        </a>
      </nav>
      <div class="desktop-nav-footer">
        <button class="theme-toggle desktop-theme-toggle" id="desktop-theme-toggle" aria-label="í…Œë§ˆ ì „í™˜">
          <i class="ph-bold ph-sun" id="desktop-theme-icon"></i>
          <span id="desktop-theme-text">ë¼ì´íŠ¸ ëª¨ë“œ</span>
        </button>
      </div>
    </aside>

    <!-- Main Content Area -->
    <main class="main-container">
      <div class="hero-detail-page">
    <div class="hero-detail-container">
      <div id="hero-skeleton" class="skeleton-container">
        <div class="skeleton hero-portrait-skeleton"></div>
        <div class="skeleton hero-name-skeleton"></div>
        <div class="skeleton hero-meta-skeleton"></div>
        <div class="skeleton skill-skeleton"></div>
        <div class="skeleton skill-skeleton"></div>
        <div class="skeleton skill-skeleton"></div>
      </div>
    <!-- Page Header (Hidden for visual, visible for SEO & Screen Readers) -->
    <div class="page-header sr-only">
      <h1 id="hero-guide-heading">ì„¸ë¸ë‚˜ì´ì¸  ë¦¬ë²„ìŠ¤ ì˜ì›… ìƒì„¸ ì •ë³´</h1>
      <p class="subtitle">ì˜ì›…ì˜ ìŠ¤íƒ¯, ìŠ¤í‚¬, í¬ê·€ë„ ë° ì†Œì†ì„ ìì„¸íˆ í™•ì¸í•˜ì„¸ìš”.</p>
    </div>

    <!-- ëª©ë¡ìœ¼ë¡œ ë²„íŠ¼ -->
    <div class="hero-nav-buttons">
      <button class="back-button" onclick="window.location.href='/index.html'"><i class="ph-bold ph-caret-left"></i> ëª©ë¡ìœ¼ë¡œ</button>
    </div>

    <!-- ì˜ì›… ìºëŸ¬ì…€ ë„¤ë¹„ê²Œì´ì…˜ -->
    <section class="hero-carousel-section">
      <button class="carousel-nav-btn carousel-nav-prev" id="carousel-prev" aria-label="ì´ì „ ì˜ì›…">
        <i class="ph-bold ph-caret-left"></i>
      </button>
      <div class="hero-carousel" id="hero-carousel">
        <!-- JavaScriptë¡œ ë™ì  ìƒì„± -->
      </div>
      <button class="carousel-nav-btn carousel-nav-next" id="carousel-next" aria-label="ë‹¤ìŒ ì˜ì›…">
        <i class="ph-bold ph-caret-right"></i>
      </button>
    </section>

    <section class="hero-top">
      <div class="hero-center-content">
        <div class="hero-portrait-wrap">
          <img id="hero-portrait" class="hero-portrait" alt="ì˜ì›… ì´ˆìƒí™”" />
        </div>

        <div class="hero-basic-info">
          <p id="hero-nickname" class="hero-nickname"></p>
          <h2 id="hero-name" class="hero-name"></h2>
          <div class="hero-meta">
            <span id="hero-group" class="hero-group"></span>
            <span id="hero-type" class="hero-type"></span>
            <span id="hero-rarity" class="hero-rarity"></span>
          </div>

          <!-- Average Rating Display -->
          <div class="hero-rating-display" id="hero-rating-display" style="display: none;">
            <div class="rating-stars">
              <i class="ph-fill ph-star"></i>
              <span class="rating-value" id="average-rating">0.0</span>
            </div>
            <span class="rating-count">(<span id="comment-count">0</span>)</span>
          </div>
        </div>
      </div>
    </section>

    <!-- íƒ­ ë„¤ë¹„ê²Œì´ì…˜ -->
    <div class="hero-tabs">
      <button class="tab-btn active" data-tab="stats">ìŠ¤íƒ¯</button>
      <button class="tab-btn" data-tab="skills">ìŠ¤í‚¬</button>
      <button class="tab-btn" data-tab="comments">ì˜ê²¬</button>
      <button class="tab-btn" data-tab="history">ì—…ë°ì´íŠ¸</button>
    </div>

    <!-- íƒ­ ì»¨í…ì¸  -->
    <div class="tab-content active" id="tab-stats">
      <section class="hero-stats-container">
        <!-- ì¢Œì¸¡: ê¸°ë³¸ ìŠ¤íƒ¯ -->
        <div class="stats-left">
          <p class="stats-info">30ë ˆë²¨ 5ê°•í™” 0ì´ˆì›” ê¸°ì¤€ì…ë‹ˆë‹¤</p>
          <table class="stats-table">
            <tr><td>ê³µê²©ë ¥</td><td id="atk"></td></tr>
            <tr><td>ë°©ì–´ë ¥</td><td id="def"></td></tr>
            <tr><td>ìƒëª…ë ¥</td><td id="hp"></td></tr>
            <tr><td>ì†ê³µ</td><td id="spd"></td></tr>
            <tr><td>ì¹˜ëª…íƒ€ í™•ë¥ (%)</td><td id="crit_rate"></td></tr>
            <tr><td>ì¹˜ëª…íƒ€ í”¼í•´(%)</td><td id="crit_dmg"></td></tr>
            <tr><td>ì•½ì  ê³µê²© í™•ë¥ (%)</td><td id="weak_rate"></td></tr>
            <tr><td>ë§‰ê¸° í™•ë¥ (%)</td><td id="block_rate"></td></tr>
            <tr><td>ë°›ëŠ” í”¼í•´ ê°ì†Œ(%)</td><td id="dmg_reduce"></td></tr>
            <tr><td>íš¨ê³¼ ì ì¤‘(%)</td><td id="eff_hit"></td></tr>
            <tr><td>íš¨ê³¼ ì €í•­(%)</td><td id="eff_res"></td></tr>
          </table>
        </div>

        <!-- ìš°ì¸¡: ì´ˆì›” ìŠ¤íƒ¯ -->
        <div class="stats-right">
          <h3 class="transcendence-title">ì´ˆì›” ë‹¨ê³„ë³„ ìŠ¤íƒ¯</h3>
          <div id="transcendence-levels" class="transcendence-levels">
            <!-- JavaScriptë¡œ ë™ì  ìƒì„± -->
          </div>
        </div>
      </section>
    </div>

    <div class="tab-content" id="tab-skills">
      <section class="hero-skills">
        <div class="skill attack-skill">
          <h3>ê¸°ë³¸ ê³µê²©</h3>
          <img id="attack-image" alt="ê³µê²© ì´ë¯¸ì§€" />
          <p><strong id="attack-name" class="skill-name"></strong> <span id="attack-cooltime" class="skill-cooltime"></span></p>
          <p id="attack-desc" class="skill-desc"></p>
        </div>

        <!-- Active Skill 1 - ë™ì  ë Œë”ë§ -->
        <div id="active-1-container"></div>

        <div class="skill active-skill-2">
          <h3>ì•¡í‹°ë¸Œ ìŠ¤í‚¬ 2</h3>
          <img id="active-2-image" alt="ì•¡í‹°ë¸Œ ìŠ¤í‚¬ 2 ì´ë¯¸ì§€" />
          <p><strong id="active-2-name" class="skill-name"></strong> <span id="active-2-cooltime" class="skill-cooltime"></span></p>
          <p id="active-2-desc" class="skill-desc"></p>
        </div>
        <div class="skill passive-skill">
          <h3>íŒ¨ì‹œë¸Œ</h3>
          <img id="passive-image" alt="íŒ¨ì‹œë¸Œ ì´ë¯¸ì§€" />
          <p><strong id="passive-name" class="skill-name"></strong> <span id="passive-cooltime" class="skill-cooltime"></span></p>
          <p id="passive-desc" class="skill-desc"></p>
        </div>
      </section>
    </div>

    <div class="tab-content" id="tab-comments">
      <section class="hero-comments">
        <form id="comment-form">
          <input type="text" id="nickname" name="nickname" placeholder="ë‹‰ë„¤ì„" required />

          <!-- Star Rating Input -->
          <div class="rating-input-container">
            <label for="rating-input" class="rating-label">
              <i class="ph-fill ph-star"></i>
              í‰ê°€
            </label>
            <div class="star-rating-input" id="star-rating-input">
              <span class="star" data-rating="1">â˜…</span>
              <span class="star" data-rating="2">â˜…</span>
              <span class="star" data-rating="3">â˜…</span>
              <span class="star" data-rating="4">â˜…</span>
              <span class="star" data-rating="5">â˜…</span>
            </div>
            <input type="hidden" id="rating-value" name="rating" value="0" required />
          </div>

          <textarea id="comment-content" name="content" placeholder="ì˜ê²¬ì„ ì…ë ¥í•˜ì„¸ìš”..." required></textarea>
          <button type="submit">ë“±ë¡</button>
        </form>
        <ul id="comment-list" class="comment-list"></ul>
      </section>
    </div>

    <div class="tab-content" id="tab-history">
      <section class="hero-history">
        <div id="history-timeline" class="history-timeline">
          <!-- JavaScriptë¡œ ë™ì  ìƒì„± -->
        </div>
      </section>
    </div>
    </div>
      </div>

  <script>
    const heroName = window.heroId;
    const heroId = heroName ? heroName : null;

    if (!heroId) {
      document.querySelector("main").innerHTML = "<p>ìœ íš¨í•˜ì§€ ì•Šì€ ì˜ì›… IDì…ë‹ˆë‹¤.</p>";
    } else {
      const skeleton = document.getElementById("hero-skeleton");
      const container = document.querySelector(".hero-detail-container");
      if (container && skeleton) {
        container.classList.add("loading");
        skeleton.style.display = "block";
      }
      fetch(`/api/hero/name/${encodeURIComponent(heroId)}`, { cache: 'no-store' })
        .then(res => {
          if (!res.ok) throw new Error(`HTTP ${res.status}`);
          return res.json();
        })
        .then(hero => {
          if (container && skeleton) {
            container.classList.remove("loading");
            skeleton.style.display = "none";
          }
          if (!hero || !hero.name) {
            document.querySelector("main").innerHTML = "<p>ì˜ì›… ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</p>";
            return;
          }

          // === (êµ¬)ì„¸ë¸ë‚˜ì´ì¸  ì „ìš© data-group ì†ì„± ì¶”ê°€ ===
          if (hero.group) {
            const pageContainer = document.querySelector(".hero-detail-page");
            if (pageContainer) {
              pageContainer.setAttribute("data-group", hero.group);
              if (hero.group.includes("(êµ¬)ì„¸ë¸ë‚˜ì´ì¸ ")) {
                pageContainer.classList.add("old-sevenknights");
                console.log(`ğŸ’œ (êµ¬)ì„¸ë¸ë‚˜ì´ì¸  ê·¸ë£¹ ê°ì§€ë¨ â†’ ${hero.name}`);
              } else {
                console.log(`ğŸ’› ì¼ë°˜ ê·¸ë£¹ â†’ ${hero.name}`);
              }
            }
          }

          // Update SEO meta tags dynamically
          const heroTitle = `${hero.name} (${hero.rarity} / ${hero.type}) - ì„¸ë‚˜DB`;
          document.title = heroTitle;
          const titleEl = document.getElementById("dynamic-title");
          if (titleEl) titleEl.textContent = heroTitle;

          // í’ë¶€í•˜ê³  ê°€ì´ë“œ ìŠ¤íƒ€ì¼ì˜ ì„¤ëª… ë° í‚¤ì›Œë“œ
          const groupText = hero.group || "ì„¸ë¸ë‚˜ì´ì¸  ë¦¬ë²„ìŠ¤";
          const guideDesc = `ì„¸ë¸ë‚˜ì´ì¸  ë¦¬ë²„ìŠ¤ ${hero.name} ì™„ë²½ ê³µëµ: ìŠ¤í‚¬, ì„±ëŠ¥, ì¥ë¹„, ì¶”ì²œ ì„¸íŒ…, í™œìš©ë²•ê¹Œì§€ ì´ì •ë¦¬! ${groupText} ì†Œì† ${hero.rarity} ë“±ê¸‰ ${hero.type} ì˜ì›…ì˜ ìŠ¤íƒ¯, ìŠ¤í‚¬ ì •ë³´, ì¥ì ê³¼ ë‹¨ì , íŒŒí‹° ì¡°í•©, ì¶”ì²œ ì¥ë¹„, ì„±ì¥ íŒ, PvE/PvP í™œìš©ë²• ë“± ëª¨ë“  ì •ë³´ë¥¼ í•œëˆˆì— í™•ì¸í•˜ì„¸ìš”.`;
          const desc = guideDesc;
          const url = `${location.origin}${location.pathname}?id=${encodeURIComponent(heroId)}`;

          // <h1> ì—…ë°ì´íŠ¸
          const heading = document.getElementById("hero-guide-heading");
          if (heading) heading.textContent = `ì„¸ë¸ë‚˜ì´ì¸  ë¦¬ë²„ìŠ¤ ${hero.name} ì™„ë²½ ê³µëµ: ìŠ¤í‚¬, ì„±ëŠ¥, ì¥ë¹„ ì´ì •ë¦¬`;

          // Description
          const descMeta = document.getElementById("meta-description");
          if (descMeta) descMeta.setAttribute("content", desc);

          // Keywords: ì˜ì›…ëª…, ì†Œì†, íƒ€ì…, í¬ê·€ë„, ê°€ì´ë“œ/ê³µëµ ê´€ë ¨ ê²€ìƒ‰ì–´ í¬í•¨
          const keywordsMeta = document.getElementById("meta-keywords");
          if (keywordsMeta) {
            const keywordsArr = [
              "ì„¸ë¸ë‚˜ì´ì¸  ë¦¬ë²„ìŠ¤", "Seven Knights Re:birth", "ì˜ì›…", "ìƒì„¸", "ë„ê°", "ê³µëµ", "ê°€ì´ë“œ", "ìŠ¤í‚¬", "ì„±ëŠ¥", "ì¥ë¹„", "ì¶”ì²œ", "ì„¸íŒ…", "ì¡°í•©", "ì„±ì¥", "íŒ", "PVP", "PVE", "íŒŒí‹°", "í™œìš©ë²•",
              hero.name, hero.nickname, groupText, hero.type, hero.rarity
            ];
            // Remove duplicates and falsy
            const keywords = Array.from(new Set(keywordsArr.filter(Boolean))).join(", ");
            keywordsMeta.setAttribute("content", keywords);
          }

          // Open Graph
          const ogTitle = document.getElementById("og-title");
          if (ogTitle) ogTitle.setAttribute("content", heroTitle);
          const ogDescEl = document.getElementById("og-description");
          if (ogDescEl) ogDescEl.setAttribute("content", desc);
          const ogImage = document.getElementById("og-image");
          if (ogImage) ogImage.setAttribute("content", hero.portrait || "/default-hero-og-image.png");
          const ogUrl = document.getElementById("og-url");
          if (ogUrl) ogUrl.setAttribute("content", url);

          // Twitter Card
          const twTitle = document.getElementById("twitter-title");
          if (twTitle) twTitle.setAttribute("content", heroTitle);
          const twDesc = document.getElementById("twitter-description");
          if (twDesc) twDesc.setAttribute("content", desc);
          const twImage = document.getElementById("twitter-image");
          if (twImage) twImage.setAttribute("content", hero.portrait || "/default-hero-og-image.png");

          // Canonical
          const canonical = document.getElementById("canonical-link");
          if (canonical) canonical.setAttribute("href", url);

          // âœ… êµ¬ì¡°í™” ë°ì´í„°(JSON-LD) ë™ì  ìƒì„± (VideoGameCharacter + Article)
          const keywordsArr = [
            "ì„¸ë¸ë‚˜ì´ì¸  ë¦¬ë²„ìŠ¤", "Seven Knights Re:birth", "ì˜ì›…", "ìƒì„¸", "ë„ê°", "ê³µëµ", "ê°€ì´ë“œ", "ìŠ¤í‚¬", "ì„±ëŠ¥", "ì¥ë¹„", "ì¶”ì²œ", "ì„¸íŒ…", "ì¡°í•©", "ì„±ì¥", "íŒ", "PVP", "PVE", "íŒŒí‹°", "í™œìš©ë²•",
            hero.name, hero.nickname, groupText, hero.type, hero.rarity
          ];
          const jsonLdObj = [
            {
              "@context": "https://schema.org",
              "@type": "VideoGameCharacter",
              "name": hero.name,
              "alternateName": hero.nickname || undefined,
              "description": desc,
              "image": hero.portrait || "/default-hero-og-image.png",
              "url": url,
              "inLanguage": "ko",
              "rarity": hero.rarity,
              "characterAttribute": hero.type,
              "memberOf": groupText,
              "isPartOf": {
                "@type": "VideoGame",
                "name": "ì„¸ë¸ë‚˜ì´ì¸  ë¦¬ë²„ìŠ¤ (Seven Knights Re:birth)"
              }
            },
            {
              "@context": "https://schema.org",
              "@type": "Article",
              "headline": `ì„¸ë¸ë‚˜ì´ì¸  ë¦¬ë²„ìŠ¤ ${hero.name} ì™„ë²½ ê³µëµ: ìŠ¤í‚¬, ì„±ëŠ¥, ì¥ë¹„ ì´ì •ë¦¬`,
              "articleSection": "ì˜ì›… ê°€ì´ë“œ, ìƒì„¸ ì •ë³´, ìŠ¤í‚¬/ì„±ëŠ¥/ì¥ë¹„ ë¶„ì„",
              "about": hero.name,
              "author": { "@type": "Organization", "name": "ì„¸ë‚˜DB" },
              "inLanguage": "ko",
              "image": hero.portrait || "/default-hero-og-image.png",
              "datePublished": hero.datePublished || undefined,
              "dateModified": hero.dateModified || undefined,
              "mainEntityOfPage": url,
              "keywords": Array.from(new Set(keywordsArr.filter(Boolean))).join(", "),
              "description": desc,
              "url": url
            }
          ];
          const jsonLdEl = document.querySelector('script[type="application/ld+json"]');
          if (jsonLdEl) {
            jsonLdEl.textContent = JSON.stringify(jsonLdObj, null, 2);
          }

          // === Hero portrait area rendering (index.html card logic adapted) ===
          (function renderHeroPortrait() {
            // Remove existing children
            const wrap = document.querySelector(".hero-portrait-wrap");
            if (!wrap) return;
            wrap.innerHTML = "";
            wrap.style.position = "relative";

            // Determine rarityClass (for border/background)
            const rarityClass = (() => {
              switch (hero.rarity) {
                case "ì „ì„¤+": return "legendary-plus";
                case "ì „ì„¤": return "legendary";
                case "í¬ê·€": return "rare";
                case "ê³ ê¸‰": return "uncommon";
                default: return "normal";
              }
            })();

            // Portrait img
            const img = document.createElement("img");
            img.className = `hero-portrait rarity-${rarityClass}`;
            img.alt = "ì˜ì›… ì´ˆìƒí™”";
            img.src = hero.portrait || "";

            img.addEventListener('error', function() {
              console.warn(`ì´ˆìƒí™” ë¡œë“œ ì‹¤íŒ¨: ${hero.name}`);
              this.style.display = 'none'; // Hide broken image
            });

            // Add shine border if hasEffect
            if (hero.hasEffect === true || hero.hasEffect === "true" || hero.hasEffect === 1) {
              img.classList.add("has-effect");
            }
            wrap.appendChild(img);

            // Rarity border PNG if hasEffect
            if (hero.hasEffect === true || hero.hasEffect === "true" || hero.hasEffect === 1) {
              const isOldSevenKnights = hero.group && hero.group.includes("(êµ¬)ì„¸ë¸ë‚˜ì´ì¸ ");
              const borderImg = document.createElement("img");
              borderImg.className = "rarity-border";
              borderImg.src = isOldSevenKnights
                ? "/images/border-legendary-oldsena.png"
                : "/images/border-legendary.png";
              borderImg.alt = "ì „ì„¤ í…Œë‘ë¦¬";
              wrap.appendChild(borderImg);
            }

            // Type badge (if hero.typeImage)
            if (hero.typeImage) {
              const badge = document.createElement("img");
              badge.className = "hero-type-badge";
              badge.src = hero.typeImage;
              badge.alt = hero.type || "íƒ€ì…";
              badge.style.position = "absolute";
              badge.style.left = "8px";
              badge.style.bottom = "8px";
              badge.style.width = "28px";
              badge.style.height = "28px";
              badge.style.zIndex = "2";
              wrap.appendChild(badge);
            }
          })();
          document.getElementById("hero-name").textContent = hero.name || "";
          document.getElementById("hero-nickname").textContent = hero.nickname || "";
          document.getElementById("hero-group").textContent = hero.group || "";

          // Set hero type with icon and color class
          const heroTypeEl = document.getElementById("hero-type");
          heroTypeEl.innerHTML = ""; // Clear previous content

          // Add type icon if available
          if (hero.typeImage) {
            const typeIcon = document.createElement("img");
            typeIcon.src = hero.typeImage;
            typeIcon.alt = hero.type || "íƒ€ì…";
            typeIcon.className = "hero-type-icon";
            typeIcon.style.width = "20px";
            typeIcon.style.height = "20px";
            typeIcon.style.marginRight = "6px";
            typeIcon.style.verticalAlign = "middle";
            heroTypeEl.appendChild(typeIcon);
          }

          // Add type text
          const typeText = document.createTextNode(hero.type || "");
          heroTypeEl.appendChild(typeText);

          const typeClassMap = {
            "ê³µê²©í˜•": "type-attack",
            "ë§ˆë²•í˜•": "type-magic",
            "ì§€ì›í˜•": "type-support",
            "ë§ŒëŠ¥í˜•": "type-versatile",
            "ë°©ì–´í˜•": "type-defense"
          };
          const typeClass = typeClassMap[hero.type];
          if (typeClass) {
            heroTypeEl.className = "hero-type " + typeClass;
          }

          // Set hero rarity with color class
          const heroRarityEl = document.getElementById("hero-rarity");
          heroRarityEl.textContent = hero.rarity || "";
          const rarityClassMap = {
            "ì „ì„¤+": "rarity-legendary-plus",
            "ì „ì„¤": "rarity-legendary",
            "í¬ê·€": "rarity-rare"
          };
          const rarityClass = rarityClassMap[hero.rarity];
          if (rarityClass) {
            heroRarityEl.className = "hero-rarity " + rarityClass;
          }

          // ìŠ¤íƒ¯
          const statFields = ["atk","def","hp","spd","crit_rate","crit_dmg","weak_rate","block_rate","dmg_reduce","eff_hit","eff_res"];
          statFields.forEach(field => {
            document.getElementById(field).textContent = hero[field] || "-";
          });

          // ìŠ¤í‚¬ ì¶œë ¥ í•¨ìˆ˜
          // Simple markdown parser for skill descriptions
          const parseMarkdown = (text) => {
            if (!text) return "";

            // Helper function to parse markdown within a sentence
            const parseMarkdownInline = (sentence) => {
              // Escape HTML first to prevent XSS
              let html = sentence
                .replace(/&/g, '&amp;')
                .replace(/</g, '&lt;')
                .replace(/>/g, '&gt;');

              // Parse markdown (in order of precedence)
              html = html
                // Bold: **text** or __text__
                .replace(/\*\*(.+?)\*\*/g, '<strong>$1</strong>')
                .replace(/__(.+?)__/g, '<strong>$1</strong>')
                // Italic: *text* or _text_ (but not inside words)
                .replace(/(?<!\w)\*(.+?)\*(?!\w)/g, '<em>$1</em>')
                .replace(/(?<!\w)_(.+?)_(?!\w)/g, '<em>$1</em>')
                // Code: `text`
                .replace(/`(.+?)`/g, '<code>$1</code>')
                // Links: [text](url)
                .replace(/\[(.+?)\]\((.+?)\)/g, '<a href="$2" target="_blank" rel="noopener noreferrer">$1</a>');

              return html;
            };

            // First, split text into blocks based on effect markers
            // This ensures multi-line effect descriptions stay together
            const effectMarkers = [
              { marker: '[ìŠ¤í‚¬ ê°•í™”]', className: 'skill-effect-box skill-enhancement' },
              { marker: '[6ì´ˆì›”]', className: 'skill-effect-box awakening-6' },
              { marker: '[2ì´ˆì›”]', className: 'skill-effect-box awakening-2' }
            ];

            // Process blocks with effect markers
            let processedText = text;
            const blocks = [];
            let lastIndex = 0;

            // Find all marker positions
            const markerPositions = [];
            effectMarkers.forEach(({ marker, className }) => {
              let index = processedText.indexOf(marker);
              while (index !== -1) {
                markerPositions.push({ index, marker, className });
                index = processedText.indexOf(marker, index + 1);
              }
            });

            // Sort markers by position
            markerPositions.sort((a, b) => a.index - b.index);

            // Split text into blocks based on markers
            markerPositions.forEach((markerInfo, i) => {
              const { index, marker, className } = markerInfo;

              // Add text before this marker as a regular block
              if (index > lastIndex) {
                blocks.push({
                  text: processedText.substring(lastIndex, index),
                  className: null
                });
              }

              // Find end of this effect block (next marker or end of text)
              const nextMarkerIndex = i < markerPositions.length - 1
                ? markerPositions[i + 1].index
                : processedText.length;

              // Extract content after marker (remove the marker itself)
              const content = processedText.substring(index + marker.length, nextMarkerIndex).trim();

              blocks.push({
                text: content,
                className: className
              });

              lastIndex = nextMarkerIndex;
            });

            // Add remaining text
            if (lastIndex < processedText.length) {
              blocks.push({
                text: processedText.substring(lastIndex),
                className: null
              });
            }

            // If no markers found, treat entire text as one block
            if (blocks.length === 0) {
              blocks.push({ text: processedText, className: null });
            }

            // Process each block
            const processedBlocks = blocks.map(block => {
              if (!block.text.trim()) return '';

              // If this block has an effect class, wrap entire block without target styling
              if (block.className) {
                const lines = block.text.split(/\n/).map(line => {
                  if (!line.trim()) return '';
                  return parseMarkdownInline(line);
                }).filter(l => l).join('<br>');

                return '<div class="' + block.className + '">' + lines + '</div>';
              }

              // Regular block - process with target patterns
              const sentences = block.text.split(/(?<=[.!?])\s+|\n/);

              const processedSentences = sentences.map(sentence => {
                if (!sentence.trim()) return '';

                // Define target type patterns (in priority order)
                const targetPatterns = [
                  // ì êµ° ë‹¤ì¤‘ (ê°€ì¥ ìš°ì„ )
                  {
                    pattern: /ëª¨ë“  ì êµ°|ì „ì²´ ì êµ°|ì êµ° \d+ëª…/,
                    type: 'target-enemy-multi'
                  },
                  // ì êµ° ë‹¨ì¼
                  {
                    pattern: /ë‹¨ì¼ ì êµ°|(?:ê³µê²©ë ¥|ë°©ì–´ë ¥|ìƒëª…ë ¥|ì²´ë ¥|ì†ê³µ)ì´ ê°€ì¥ (?:ë†’ì€|ë‚®ì€) ì êµ°|ë¬´ì‘ìœ„ ì êµ° 1ëª…|ëŒ€ìƒ ì êµ°|ì êµ° 1ëª…/,
                    type: 'target-enemy-single'
                  },
                  // ì•„êµ° ë‹¤ì¤‘
                  {
                    pattern: /ëª¨ë“  ì•„êµ°|ì „ì²´ ì•„êµ°|ì•„êµ° \d+ëª…|(?:ê³µê²©ë ¥|ë°©ì–´ë ¥|ìƒëª…ë ¥|ì²´ë ¥|ì†ê³µ)ì´ ê°€ì¥ (?:ë†’ì€|ë‚®ì€) ì•„êµ° \d+ëª…/,
                    type: 'target-ally-multi'
                  },
                  // ì•„êµ° ë‹¨ì¼
                  {
                    pattern: /ìì‹ |ë‹¨ì¼ ì•„êµ°|(?:ê³µê²©ë ¥|ë°©ì–´ë ¥|ìƒëª…ë ¥|ì²´ë ¥|ì†ê³µ)ì´ ê°€ì¥ (?:ë†’ì€|ë‚®ì€) ì•„êµ°|ëŒ€ìƒ ì•„êµ°|ì•„êµ° 1ëª…/,
                    type: 'target-ally-single'
                  }
                ];

                // Check which target type matches
                for (const { pattern, type } of targetPatterns) {
                  if (pattern.test(sentence)) {
                    return '<div class="skill-target-box ' + type + '">' + parseMarkdownInline(sentence) + '</div>';
                  }
                }

                // No target type found, return as-is with inline markdown
                return parseMarkdownInline(sentence);
              });

              return processedSentences.filter(s => s).join('<br>');
            });

            // Join blocks
            return processedBlocks.filter(b => b).join('');
          };

          const renderSkill = (prefix, skill) => {
            document.getElementById(`${prefix}-image`).src = skill?.image || "";
            document.getElementById(`${prefix}-name`).textContent = skill?.name || "";
            const cooltimeEl = document.getElementById(`${prefix}-cooltime`);
            if (skill?.cooltime) {
              cooltimeEl.textContent = `ì¿¨íƒ€ì„: ${skill.cooltime}`;
              cooltimeEl.style.display = '';
            } else {
              cooltimeEl.textContent = "";
              cooltimeEl.style.display = 'none';
            }
            document.getElementById(`${prefix}-desc`).innerHTML = parseMarkdown(skill?.desc || "");
          };

          // Render Active Skill 1 (with transformation support)
          const renderActiveSkill1 = (skill, transformedSkill) => {
            const container = document.getElementById('active-1-container');
            if (!container) return;

            if (transformedSkill) {
              // ë³€í™˜í˜• ìŠ¤í‚¬ - 2ë‹¨ êµ¬ì¡°
              container.innerHTML = `
                <div class="skill skill-transform">
                  <h3>ì•¡í‹°ë¸Œ ìŠ¤í‚¬ 1 <span class="skill-transform-badge">(ë³€í™˜í˜• ìŠ¤í‚¬)</span></h3>
                  <div class="skill-transform-container">
                    <div class="skill-transform-item">
                      <div class="skill-transform-label">ê¸°ë³¸ ìƒíƒœ</div>
                      <img src="${skill?.image || ''}" alt="ì•¡í‹°ë¸Œ ìŠ¤í‚¬ 1" />
                      <p><strong class="skill-name">${skill?.name || ''}</strong>${skill?.cooltime ? ` <span class="skill-cooltime">ì¿¨íƒ€ì„: ${skill.cooltime}</span>` : ''}</p>
                      <p class="skill-desc">${parseMarkdown(skill?.desc || '')}</p>
                    </div>
                    <div class="skill-transform-arrow">â†’</div>
                    <div class="skill-transform-item">
                      <div class="skill-transform-label">ë³€í™˜ í›„</div>
                      <img src="${transformedSkill?.image || ''}" alt="ë³€í™˜ í›„" />
                      <p><strong class="skill-name">${transformedSkill?.name || ''}</strong>${transformedSkill?.cooltime ? ` <span class="skill-cooltime">ì¿¨íƒ€ì„: ${transformedSkill.cooltime}</span>` : ''}</p>
                      <p class="skill-desc">${parseMarkdown(transformedSkill?.desc || '')}</p>
                    </div>
                  </div>
                </div>
              `;
            } else {
              // ì¼ë°˜ ìŠ¤í‚¬
              container.innerHTML = `
                <div class="skill active-skill-1">
                  <h3>ì•¡í‹°ë¸Œ ìŠ¤í‚¬ 1</h3>
                  <img src="${skill?.image || ''}" alt="ì•¡í‹°ë¸Œ ìŠ¤í‚¬ 1 ì´ë¯¸ì§€" />
                  <p><strong class="skill-name">${skill?.name || ''}</strong>${skill?.cooltime ? ` <span class="skill-cooltime">ì¿¨íƒ€ì„: ${skill.cooltime}</span>` : ''}</p>
                  <p class="skill-desc">${parseMarkdown(skill?.desc || '')}</p>
                </div>
              `;
            }
          };

          // Render History Timeline
          const renderHistory = (history) => {
            const timeline = document.getElementById('history-timeline');
            if (!timeline) return;

            if (!history || history.length === 0) {
              timeline.innerHTML = '<p class="history-empty">ì—…ë°ì´íŠ¸ íˆìŠ¤í† ë¦¬ê°€ ì—†ìŠµë‹ˆë‹¤.</p>';
              return;
            }

            timeline.innerHTML = history.map(entry => `
              <div class="history-entry">
                <div class="history-date">${entry.date || ''}</div>
                <div class="history-dot"></div>
                <div class="history-content">
                  <span class="history-type history-type-${entry.type?.toLowerCase() || 'default'}">${entry.type || ''}</span>
                  <p class="history-text">${entry.content || ''}</p>
                </div>
              </div>
            `).join('');
          };

          // Render Transcendence Levels
          const renderTranscendence = (transLevelText) => {
            const container = document.getElementById('transcendence-levels');
            if (!container) return;

            if (!transLevelText || transLevelText.trim() === '') {
              container.innerHTML = '<p class="transcendence-empty">ì´ˆì›” ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.</p>';
              return;
            }

            // Split by double newlines to separate each transcendence level
            const levels = transLevelText.trim().split(/\n\n+/);

            container.innerHTML = levels.map((levelText, index) => {
              const levelNum = index + 1;
              // Replace newlines with <br> for display
              const formattedText = levelText.trim().replace(/\n/g, '<br>');

              return `
                <div class="transcendence-box">
                  <div class="transcendence-level-number">${levelNum}ì´ˆì›”</div>
                  <div class="transcendence-content">${formattedText}</div>
                </div>
              `;
            }).join('');
          };

          renderSkill("attack", hero.attack);
          renderActiveSkill1(hero.active_1, hero.active_1_change);
          renderSkill("active-2", hero.active_2);
          renderSkill("passive", hero.passive);
          renderHistory(hero.history);
          renderTranscendence(hero.transLevel);

          const descEl = document.getElementById("hero-description");
          if (descEl) descEl.textContent = hero.description || "";

        })
        .catch(err => {
          if (container && skeleton) {
            container.classList.remove("loading");
            skeleton.style.display = "none";
          }
          console.error("Hero fetch error:", err);
          document.querySelector("main").innerHTML = "<p>ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.</p>";
        });
    }
</script>

  <script>
    // Star Rating Input
    const starInput = document.getElementById('star-rating-input');
    const ratingValue = document.getElementById('rating-value');

    if (starInput) {
      const stars = starInput.querySelectorAll('.star');
      let currentRating = 0;

      stars.forEach(star => {
        star.addEventListener('mouseenter', () => {
          const rating = parseInt(star.dataset.rating);
          updateStarDisplay(rating, true);
        });

        star.addEventListener('click', () => {
          currentRating = parseInt(star.dataset.rating);
          ratingValue.value = currentRating;
          updateStarDisplay(currentRating, false);
        });
      });

      starInput.addEventListener('mouseleave', () => {
        updateStarDisplay(currentRating, false);
      });

      function updateStarDisplay(rating, isHover) {
        stars.forEach(star => {
          const starRating = parseInt(star.dataset.rating);
          star.classList.remove('selected', 'hovered');

          if (isHover) {
            if (starRating <= rating) {
              star.classList.add('hovered');
            }
          } else {
            if (starRating <= rating) {
              star.classList.add('selected');
            }
          }
        });
      }

      // Expose reset function
      window.resetRating = function() {
        currentRating = 0;
        ratingValue.value = "0";
        stars.forEach(star => star.classList.remove('selected', 'hovered'));
      };
    }
  </script>

  <script>
    const commentForm = document.getElementById("comment-form");
    const commentList = document.getElementById("comment-list");

    // Calculate and display average rating
    function updateAverageRating(comments) {
      const ratingDisplay = document.getElementById('hero-rating-display');
      const avgRatingEl = document.getElementById('average-rating');
      const commentCountEl = document.getElementById('comment-count');

      if (!comments || comments.length === 0) {
        ratingDisplay.style.display = 'none';
        return;
      }

      const ratingsWithValues = comments.filter(c => c.rating && c.rating > 0);

      if (ratingsWithValues.length === 0) {
        ratingDisplay.style.display = 'none';
        return;
      }

      const totalRating = ratingsWithValues.reduce((sum, c) => sum + c.rating, 0);
      const avgRating = (totalRating / ratingsWithValues.length).toFixed(1);

      avgRatingEl.textContent = avgRating;
      commentCountEl.textContent = comments.length;
      ratingDisplay.style.display = 'flex';
    }

    // ëŒ“ê¸€ ë¶ˆëŸ¬ì˜¤ê¸°
    async function loadComments() {
      try {
        const res = await fetch(`/api/comments/${window.heroId}`);
        if (!res.ok) throw new Error(`HTTP ${res.status}`);
        const data = await res.json();

        commentList.innerHTML = "";
        (data.comments || []).forEach(comment => {
          const li = document.createElement("li");

          // Create rating stars display
          const rating = comment.rating || 0;
          let ratingHTML = '<div class="comment-rating">';
          for (let i = 1; i <= 5; i++) {
            ratingHTML += `<span class="star ${i <= rating ? '' : 'empty'}">â˜…</span>`;
          }
          ratingHTML += '</div>';

          li.innerHTML = `
            <strong>${comment.nickname}</strong>
            ${ratingHTML}
            <p>${comment.content}</p>
            <span>${comment.timestamp || ""}</span>
          `;
          commentList.appendChild(li);
        });

        // Update average rating display
        updateAverageRating(data.comments || []);
      } catch (err) {
        console.error("ëŒ“ê¸€ ë¶ˆëŸ¬ì˜¤ê¸° ì˜¤ë¥˜:", err);
      }
    }

    // ëŒ“ê¸€ ë“±ë¡
commentForm.addEventListener("submit", async (e) => {
  e.preventDefault();
  const nickname = document.getElementById("nickname").value.trim();
  const content = document.getElementById("comment-content").value.trim();
  const rating = parseInt(document.getElementById("rating-value").value);

  if (!nickname || !content) return alert("ë‹‰ë„¤ì„ê³¼ ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.");
  if (!rating || rating < 1 || rating > 5) return alert("ë³„ì ì„ ì„ íƒí•´ì£¼ì„¸ìš” (1-5).");

  try {
    // âœ… [ì¶”ê°€ëœ ë¶€ë¶„] ì‹¤ì œë¡œ ì „ì†¡ë˜ëŠ” ë°ì´í„°ë¥¼ ì½˜ì†”ì— ì¶œë ¥
    console.log("ğŸ“© ì „ì†¡ ë°ì´í„°:", { heroId: window.heroId, nickname, content, rating });

    const res = await fetch(`/api/comments/${window.heroId}`, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ heroId: window.heroId, nickname, content, rating }),
    });

    // âœ… [ì¶”ê°€ëœ ë¶€ë¶„] ì„œë²„ ì‘ë‹µ ìƒíƒœ ì½”ë“œ í™•ì¸
    console.log("ğŸ“© ì„œë²„ ì‘ë‹µ ìƒíƒœ:", res.status);

    if (!res.ok) throw new Error(`HTTP ${res.status}`);
    document.getElementById("comment-content").value = "";
    document.getElementById("nickname").value = "";
    // Reset star rating
    if (window.resetRating) window.resetRating();

    await loadComments();
  } catch (err) {
    console.error("âŒ ëŒ“ê¸€ ë“±ë¡ ì˜¤ë¥˜:", err);
    alert("ëŒ“ê¸€ ë“±ë¡ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
  }
});

    // ì´ˆê¸° ë¡œë“œ
    loadComments();
  </script>

  <script>
    // ì˜ì›… ìºëŸ¬ì…€ ë„¤ë¹„ê²Œì´ì…˜
    let allHeroes = [];
    let currentHeroIndex = -1;

    // ì „ì²´ ì˜ì›… ëª©ë¡ ê°€ì ¸ì˜¤ê¸° ë° ìºëŸ¬ì…€ ë Œë”ë§
    fetch('/api/heroes', { cache: 'no-store' })
      .then(res => res.json())
      .then(heroes => {
        console.log('ğŸ“Š ì „ì²´ ì˜ì›… ëª©ë¡:', heroes.length, 'ëª…');
        allHeroes = heroes.sort((a, b) => a.name.localeCompare(b.name, 'ko'));
        currentHeroIndex = allHeroes.findIndex(h => h.name === heroName);
        console.log('ğŸ¯ í˜„ì¬ ì˜ì›…:', heroName, '/ ì¸ë±ìŠ¤:', currentHeroIndex);

        // ìºëŸ¬ì…€ ë Œë”ë§
        const carousel = document.getElementById('hero-carousel');
        if (!carousel) return;

        allHeroes.forEach((hero, index) => {
          const item = document.createElement('div');
          item.className = 'carousel-item';
          if (index === currentHeroIndex) {
            item.classList.add('active');
          }

          // ë“±ê¸‰ë³„ í´ë˜ìŠ¤
          const rarityClass = (() => {
            switch (hero.rarity) {
              case "ì „ì„¤+": return "legendary-plus";
              case "ì „ì„¤": return "legendary";
              case "í¬ê·€": return "rare";
              case "ê³ ê¸‰": return "uncommon";
              default: return "normal";
            }
          })();

          const portrait = document.createElement('img');
          portrait.src = hero.portrait || '';
          portrait.alt = hero.name;
          portrait.className = `carousel-portrait rarity-${rarityClass}`;

          portrait.addEventListener('error', function() {
            this.style.display = 'none';
          });

          // hasEffect íš¨ê³¼ ì¶”ê°€
          if (hero.hasEffect === true || hero.hasEffect === "true" || hero.hasEffect === 1) {
            portrait.classList.add('has-effect');
          }

          item.appendChild(portrait);

          // Rarity border PNG if hasEffect
          if (hero.hasEffect === true || hero.hasEffect === "true" || hero.hasEffect === 1) {
            const isOldSevenKnights = hero.group && hero.group.includes("(êµ¬)ì„¸ë¸ë‚˜ì´ì¸ ");
            const borderImg = document.createElement("img");
            borderImg.className = "rarity-border";
            borderImg.src = isOldSevenKnights
              ? "/images/border-legendary-oldsena.png"
              : "/images/border-legendary.png";
            borderImg.alt = "ì „ì„¤ í…Œë‘ë¦¬";
            item.appendChild(borderImg);
          }

          // ì˜ì›… ì´ë¦„ ì¶”ê°€
          const nameLabel = document.createElement('div');
          nameLabel.className = 'carousel-name';
          nameLabel.textContent = hero.name;
          item.appendChild(nameLabel);

          // í´ë¦­ ì´ë²¤íŠ¸
          item.addEventListener('click', () => {
            window.location.href = `/hero.html?name=${encodeURIComponent(hero.name)}`;
          });

          carousel.appendChild(item);
        });

        // í˜„ì¬ ì˜ì›…ìœ¼ë¡œ ìŠ¤í¬ë¡¤
        if (currentHeroIndex !== -1) {
          const activeItem = carousel.querySelector('.carousel-item.active');
          if (activeItem) {
            setTimeout(() => {
              activeItem.scrollIntoView({ behavior: 'smooth', block: 'nearest', inline: 'center' });
            }, 100);
          }
        }

        // ìºëŸ¬ì…€ í™”ì‚´í‘œ ë²„íŠ¼ ê¸°ëŠ¥
        const prevBtn = document.getElementById('carousel-prev');
        const nextBtn = document.getElementById('carousel-next');

        if (prevBtn && nextBtn) {
          // ì´ì „ ë²„íŠ¼ í´ë¦­
          prevBtn.addEventListener('click', () => {
            const scrollAmount = 300;
            carousel.scrollBy({ left: -scrollAmount, behavior: 'smooth' });
          });

          // ë‹¤ìŒ ë²„íŠ¼ í´ë¦­
          nextBtn.addEventListener('click', () => {
            const scrollAmount = 300;
            carousel.scrollBy({ left: scrollAmount, behavior: 'smooth' });
          });

          // ìŠ¤í¬ë¡¤ ìœ„ì¹˜ì— ë”°ë¼ ë²„íŠ¼ í™œì„±í™”/ë¹„í™œì„±í™”
          function updateButtonStates() {
            const isAtStart = carousel.scrollLeft <= 0;
            const isAtEnd = carousel.scrollLeft >= carousel.scrollWidth - carousel.clientWidth - 10;

            prevBtn.disabled = isAtStart;
            nextBtn.disabled = isAtEnd;
          }

          // ì´ˆê¸° ìƒíƒœ ì„¤ì •
          updateButtonStates();

          // ìŠ¤í¬ë¡¤ ì‹œ ë²„íŠ¼ ìƒíƒœ ì—…ë°ì´íŠ¸
          carousel.addEventListener('scroll', updateButtonStates);
        }
      })
      .catch(err => console.error('âŒ ì˜ì›… ëª©ë¡ ë¡œë“œ ì‹¤íŒ¨:', err));
  </script>

  <script>
    // íƒ­ ì „í™˜ ê¸°ëŠ¥
    document.addEventListener('DOMContentLoaded', () => {
      const tabBtns = document.querySelectorAll('.tab-btn');
      const tabContents = document.querySelectorAll('.tab-content');

      tabBtns.forEach(btn => {
        btn.addEventListener('click', () => {
          const targetTab = btn.getAttribute('data-tab');

          // ëª¨ë“  íƒ­ ë²„íŠ¼ê³¼ ì»¨í…ì¸ ì—ì„œ active ì œê±°
          tabBtns.forEach(b => b.classList.remove('active'));
          tabContents.forEach(content => content.classList.remove('active'));

          // í´ë¦­ëœ íƒ­ í™œì„±í™”
          btn.classList.add('active');
          document.getElementById(`tab-${targetTab}`).classList.add('active');
        });
      });
    });
  </script>

  <script>
    // í…Œë§ˆ í† ê¸€ ê¸°ëŠ¥
    const themeToggle = document.getElementById('theme-toggle');
    const themeIcon = document.getElementById('theme-icon');
    const themeText = document.getElementById('theme-text');
    const htmlElement = document.documentElement;

    // ì €ì¥ëœ í…Œë§ˆ ë˜ëŠ” ì‹œìŠ¤í…œ ê¸°ë³¸ê°’ ê°€ì ¸ì˜¤ê¸°
    function getInitialTheme() {
      const savedTheme = localStorage.getItem('theme');
      if (savedTheme) {
        return savedTheme;
      }
      // ì‹œìŠ¤í…œ ë‹¤í¬ ëª¨ë“œ ì„¤ì • í™•ì¸
      const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
      return prefersDark ? 'dark' : 'light';
    }

    // í…Œë§ˆ ì ìš©
    function applyTheme(theme) {
      if (theme === 'light') {
        htmlElement.setAttribute('data-theme', 'light');
        themeIcon.className = 'ph-bold ph-moon';
        themeText.textContent = 'ë‹¤í¬ ëª¨ë“œ';
      } else {
        htmlElement.removeAttribute('data-theme');
        themeIcon.className = 'ph-bold ph-sun';
        themeText.textContent = 'ë¼ì´íŠ¸ ëª¨ë“œ';
      }
      localStorage.setItem('theme', theme);
    }

    // í…Œë§ˆ ì „í™˜
    function toggleTheme() {
      const currentTheme = htmlElement.getAttribute('data-theme') === 'light' ? 'light' : 'dark';
      const newTheme = currentTheme === 'light' ? 'dark' : 'light';
      applyTheme(newTheme);
    }

    // ì´ˆê¸° í…Œë§ˆ ì ìš©
    applyTheme(getInitialTheme());

    // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
    themeToggle.addEventListener('click', toggleTheme);

    // ì‹œìŠ¤í…œ í…Œë§ˆ ë³€ê²½ ê°ì§€ (ì„ íƒì‚¬í•­)
    window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', (e) => {
      if (!localStorage.getItem('theme')) {
        applyTheme(e.matches ? 'dark' : 'light');
      }
    });
  </script>

  <!-- Header, Mobile Menu, Theme Scripts -->
  <script src="/js/header.js"></script>
  <script src="/js/theme.js"></script>
  <script src="/js/mobile-menu.js"></script>
    </main>
  </div>
</body>
</html>