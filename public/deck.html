<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ì„¸ë‚˜ ë¦¬ë²„ìŠ¤ ê²°íˆ¬ì¥ ë± ì¶”ì²œ | ì„¸ë¸ë‚˜ì´ì¸  ë¦¬ë²„ìŠ¤ PVP ë± ê³µìœ  í”Œë«í¼</title>
    <!-- SEO Meta Tags -->
    <meta name="description" content="ì„¸ë‚˜ ë¦¬ë²„ìŠ¤ ê²°íˆ¬ì¥ ë± ì¶”ì²œ ë° ê³µìœ  í”Œë«í¼. ë¬´ê³¼ê¸ˆ ê²°íˆ¬ì¥ ë±ë¶€í„° ê³µë±, ë°©ë±, ë§ˆë±ê¹Œì§€ ìµœê°• ë± ì¡°í•©ì„ í™•ì¸í•˜ê³  ë‚˜ë§Œì˜ PVP ë±ì„ ê³µìœ í•˜ì„¸ìš”. í‹°ì–´, í…œ, ìŠ¤í‚¬ ìˆœì„œ, ì†ê³µ ê°€ì´ë“œ ì œê³µ.">
    <meta name="keywords" content="ì„¸ë‚˜ ê²°íˆ¬ì¥ ë±, ì„¸ë‚˜ ê²°íˆ¬ì¥ í‹°ì–´, ì„¸ë‚˜ ê²°íˆ¬ì¥ í…œ, ì„¸ë‚˜ ê²°íˆ¬ì¥ ìŠ¤í‚¬ ìˆœì„œ, ì„¸ë‚˜ ê²°íˆ¬ì¥ ì†ê³µ, ì„¸ë‚˜ ê²°íˆ¬ì¥ ë””ì‹œ, ì„¸ë‚˜ ê²°íˆ¬ì¥ ë± ë””ì‹œ, ì„¸ë‚˜ ë¦¬ë²„ìŠ¤ ê²°íˆ¬ì¥ ë± ë””ì‹œ, ì„¸ë‚˜ ë¦¬ë²„ìŠ¤ ê²°íˆ¬ì¥ ë± ì¶”ì²œ, ì„¸ë‚˜ ë¦¬ë²„ìŠ¤ ë¬´ê³¼ê¸ˆ ê²°íˆ¬ì¥ ë±, ì„¸ë‚˜ ë¬´ê³¼ê¸ˆ ê²°ì¥ë±, ì„¸ë‚˜ ë¬´ê³¼ê¸ˆ ë°©ë±, ì„¸ë‚˜ ë¬´ê³¼ê¸ˆ ê³µë±, ì„¸ë‚˜ ë¬´ê³¼ê¸ˆ ë§ˆë±, ì„¸ë‚˜ ë¦¬ë²„ìŠ¤ ê²°íˆ¬ì¥ ë±, ì„¸ë‚˜ ë¦¬ë²„ìŠ¤ ë± ì¶”ì²œ, ì„¸ë¸ë‚˜ì´ì¸  ë¦¬ë²„ìŠ¤ ê²°íˆ¬ì¥, ì„¸ë‚˜ ë¦¬ë²„ìŠ¤ PVP, ì„¸ë‚˜ ë±, ì„¸ë‚˜ ë¦¬ë²„ìŠ¤ ê²°ì¥, ì„¸ë¸ë‚˜ì´ì¸  ë¦¬ë²„ìŠ¤ ë± ì¶”ì²œ, ê²°íˆ¬ì¥ ë± ì¶”ì²œ, ì´ë ¥ì „ ë± ì¶”ì²œ, ê¸¸ë“œì „ ë± ì¶”ì²œ, ë ˆì´ë“œ ë± ì¶”ì²œ, ê²°íˆ¬ì¥ ê³µëµ, ì´ë ¥ì „ ê³µëµ, ê²°ì¥ ë±, PVP ë±, ì˜ì›… ì¡°í•©, ë± ì¡°í•©, ë± ê³µìœ , ì§„í˜•, ì•„ë ˆë‚˜, ìµœê°• ë±, ë©”íƒ€ ë±, Seven Knights Rebirth deck, Seven Knights deck, ì„¸ë‚˜ ê³µë±, ì„¸ë‚˜ ë°©ë±, ì„¸ë‚˜ ë§ˆë±, ì„¸ë‚˜ ì§€ì›ë±, ì„¸ë‚˜ ë§ŒëŠ¥ë±">
    <meta name="author" content="ì„¸ë‚˜DB">
    <meta name="robots" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1">
    <meta name="googlebot" content="index, follow">
    <meta name="naverbot" content="index, follow">
    <meta name="subject" content="ì„¸ë‚˜ ë¦¬ë²„ìŠ¤ ê²°íˆ¬ì¥ ë± ì¶”ì²œ, ì„¸ë¸ë‚˜ì´ì¸  ë¦¬ë²„ìŠ¤ PVP ë± ì¡°í•© ë° ê³µëµ">
    <meta name="rating" content="general">
    <meta name="distribution" content="global">
    <meta name="theme-color" content="#181818">
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7293515082092840"
     crossorigin="anonymous"></script>
    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="ì„¸ë‚˜ ë¦¬ë²„ìŠ¤ ê²°íˆ¬ì¥ ë± ì¶”ì²œ | ì„¸ë‚˜DB">
    <meta property="og:description" content="ì„¸ë‚˜DB - ì„¸ë‚˜ ë¦¬ë²„ìŠ¤ ê²°íˆ¬ì¥ ë± ì¶”ì²œ ë° ê³µìœ  í”Œë«í¼. ê²°íˆ¬ì¥, ì´ë ¥ì „, ê¸¸ë“œì „ ìµœê°• ë± ì¡°í•©ì„ í™•ì¸í•˜ê³  ë‚˜ë§Œì˜ PVP ë±ì„ ê³µìœ í•˜ì„¸ìš”.">
    <meta property="og:image" content="https://senadb.games/images/og-image.png">
    <meta property="og:url" content="https://senadb.games/deck.html">
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="ì„¸ë‚˜DB">
    <meta property="og:locale" content="ko_KR">
    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="ì„¸ë‚˜ ë¦¬ë²„ìŠ¤ ê²°íˆ¬ì¥ ë± ì¶”ì²œ | ì„¸ë‚˜DB">
    <meta name="twitter:description" content="ì„¸ë‚˜DB - ì„¸ë‚˜ ë¦¬ë²„ìŠ¤ ê²°íˆ¬ì¥ ë± ì¶”ì²œ ë° ê³µìœ  í”Œë«í¼. ê²°íˆ¬ì¥, ì´ë ¥ì „, ê¸¸ë“œì „ ìµœê°• ë± ì¡°í•©ì„ í™•ì¸í•˜ê³  ë‚˜ë§Œì˜ PVP ë±ì„ ê³µìœ í•˜ì„¸ìš”.">
    <meta name="twitter:image" content="https://senadb.games/images/og-image.png">
    <!-- Canonical Link -->
    <link rel="canonical" href="https://senadb.games/deck.html" />
    <!-- Structured Data for SEO -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebPage",
      "name": "ì„¸ë‚˜ ë¦¬ë²„ìŠ¤ ê²°íˆ¬ì¥ ë± ì¶”ì²œ",
      "alternateName": ["ì„¸ë¸ë‚˜ì´ì¸  ë¦¬ë²„ìŠ¤ ê²°íˆ¬ì¥ ë±", "ì„¸ë‚˜ ë¦¬ë²„ìŠ¤ PVP ë±"],
      "description": "ì„¸ë‚˜DB - ì„¸ë‚˜ ë¦¬ë²„ìŠ¤ ê²°íˆ¬ì¥ ë± ì¶”ì²œ ë° ê³µìœ  í”Œë«í¼. ê²°íˆ¬ì¥, ì´ë ¥ì „, ê¸¸ë“œì „ ìµœê°• ë± ì¡°í•© ê°€ì´ë“œ",
      "url": "https://senadb.games/deck.html",
      "inLanguage": "ko-KR",
      "isPartOf": {
        "@type": "WebSite",
        "name": "ì„¸ë‚˜DB",
        "url": "https://senadb.games/"
      },
      "about": {
        "@type": "VideoGame",
        "name": "ì„¸ë¸ë‚˜ì´ì¸  ë¦¬ë²„ìŠ¤",
        "alternateName": ["Seven Knights Rebirth", "ì„¸ë‚˜ ë¦¬ë²„ìŠ¤", "7ë‚˜ì´ì¸  ë¦¬ë²„ìŠ¤"],
        "genre": "Role-playing game"
      },
      "breadcrumb": {
        "@type": "BreadcrumbList",
        "itemListElement": [
          {
            "@type": "ListItem",
            "position": 1,
            "name": "í™ˆ",
            "item": "https://senadb.games/"
          },
          {
            "@type": "ListItem",
            "position": 2,
            "name": "ê²°íˆ¬ì¥ ë±",
            "item": "https://senadb.games/deck.html"
          }
        ]
      },
      "keywords": "ì„¸ë‚˜ ë¦¬ë²„ìŠ¤ ê²°íˆ¬ì¥ ë±, ì„¸ë‚˜ ë¦¬ë²„ìŠ¤ ë± ì¶”ì²œ, ì„¸ë¸ë‚˜ì´ì¸  ë¦¬ë²„ìŠ¤ ê²°íˆ¬ì¥, ì„¸ë‚˜ PVP, ê²°íˆ¬ì¥ ê³µëµ, ë± ì¡°í•©"
    }
    </script>
    <link rel="stylesheet" href="/style.css" />
    <script src="https://cdn.jsdelivr.net/npm/@phosphor-icons/web@2.1.2"></script>
    <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
    <!-- Google tag (gtag.js) - Only on production -->
    <script>
      // Only load analytics on production domain and not in developer mode
      // To enable developer mode (exclude your traffic):
      //   Console: localStorage.setItem('devMode', 'true')
      // To disable developer mode:
      //   Console: localStorage.removeItem('devMode')
      var isProduction = window.location.hostname === 'senadb.games';
      var isDeveloperMode = localStorage.getItem('devMode') === 'true';

      if (isProduction && !isDeveloperMode) {
        // Load gtag.js
        var gtagScript = document.createElement('script');
        gtagScript.async = true;
        gtagScript.src = 'https://www.googletagmanager.com/gtag/js?id=G-DMD8LXSEQ5';
        document.head.appendChild(gtagScript);

        // Initialize GA
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-DMD8LXSEQ5');
      } else if (isDeveloperMode) {
        console.log('Developer mode enabled - Analytics disabled');
      }
    </script>
  </head>
  <body>
    <div class="app-container">
      <!-- HeaderëŠ” /js/header.jsì—ì„œ ë™ì ìœ¼ë¡œ ìƒì„±ë©ë‹ˆë‹¤ -->

      <!-- Desktop Navigation Sidebar -->
      <aside class="desktop-nav">
        <nav>
          <a href="/index.html" class="nav-link">
            <i class="ph-bold ph-users-three"></i>
            <span>ì˜ì›… ë„ê°</span>
          </a>
          <a href="/deck.html" class="nav-link active">
            <i class="ph-bold ph-sword"></i>
            <span>ê²°íˆ¬ì¥ ë±</span>
          </a>
          <a href="/tier-list.html" class="nav-link">
            <i class="ph-bold ph-ranking"></i>
            <span>í‹°ì–´í‘œ</span>
          </a>
          <a href="/beginner-guide.html" class="nav-link">
            <i class="ph-bold ph-book-open"></i>
            <span>ì´ˆë³´ì ê°€ì´ë“œ</span>
          </a>
          <a href="/faq.html" class="nav-link">
            <i class="ph-bold ph-question"></i>
            <span>FAQ</span>
          </a>
        </nav>
        <div class="desktop-nav-footer">
          <button class="theme-toggle desktop-theme-toggle" id="desktop-theme-toggle" aria-label="í…Œë§ˆ ì „í™˜">
            <i class="ph-bold ph-sun" id="desktop-theme-icon"></i>
            <span id="desktop-theme-text">ë¼ì´íŠ¸ ëª¨ë“œ</span>
          </button>
        </div>
      </aside>

      <!-- Main Content Area -->
      <main class="main-container deck-content">
        <!-- Page Header (Hidden for visual, visible for SEO & Screen Readers) -->
        <div class="page-header sr-only">
          <h1>ê²°íˆ¬ì¥ ë± ê³µìœ </h1>
          <p class="subtitle">ë‚˜ë§Œì˜ ê²°íˆ¬ì¥ ë±ì„ êµ¬ì„±í•˜ê³  ê³µìœ í•˜ì„¸ìš”</p>
        </div>

        <!-- Tab Navigation -->
        <div class="deck-tabs">
          <button class="deck-tab active" data-tab="formation">
            <i class="ph ph-sword"></i>
            <span>ê²°íˆ¬ì¥ ë± í¸ì„±</span>
          </button>
          <button class="deck-tab" data-tab="shared">
            <i class="ph ph-users-three"></i>
            <span>ê²°íˆ¬ì¥ ë± ê³µìœ </span>
          </button>
        </div>

        <!-- Tab Content: ë± í¸ì„± -->
        <div id="tab-formation" class="deck-tab-content active">
          <div class="deck-layout">
          <!-- ì¤‘ì•™: ì§„í˜• ì„ íƒ + ë± ë°°ì¹˜ ì˜ì—­ -->
          <div class="deck-left">
            <!-- ì§„í˜• ì„ íƒ -->
            <div class="formation-selector">
              <h3 class="sr-only">ì§„í˜• ì„ íƒ</h3>
              <div class="formation-options">
                <label class="formation-option active">
                  <input type="radio" name="formation" value="default" checked>
                  <span class="formation-name">ê¸°ë³¸</span>
                </label>
                <label class="formation-option">
                  <input type="radio" name="formation" value="balance">
                  <span class="formation-name">ë°¸ëŸ°ìŠ¤</span>
                </label>
                <label class="formation-option">
                  <input type="radio" name="formation" value="attack">
                  <span class="formation-name">ê³µê²©</span>
                </label>
                <label class="formation-option">
                  <input type="radio" name="formation" value="defense">
                  <span class="formation-name">ë³´í˜¸</span>
                </label>
              </div>
            </div>

            <!-- ë± ë°°ì¹˜ -->
            <div class="deck-display">
              <h2 class="sr-only">ë‚˜ì˜ ë±</h2>
              <div class="deck-formation">
                <!-- ë’·ì¤„ (ì™¼ìª½) -->
                <div class="formation-line back-line">
                  <div class="line-label">ë’·ì¤„ (BACK)</div>
                  <div id="back-slots" class="formation-slots"></div>
                </div>

                <!-- ì•ì¤„ (ì˜¤ë¥¸ìª½) -->
                <div class="formation-line front-line">
                  <div class="line-label">ì•ì¤„ (FRONT)</div>
                  <div id="front-slots" class="formation-slots"></div>
                </div>

                <!-- í« ìŠ¬ë¡¯ -->
                <div class="pet-slot-container">
                  <div class="line-label">í« (PET)</div>
                  <div id="pet-slot" class="deck-slot pet-slot">
                    <div class="slot-indicator">P</div>
                    <div class="slot-placeholder">+</div>
                  </div>
                </div>
              </div>
            </div>

            <!-- ë± ì•¡ì…˜ ë²„íŠ¼ -->
            <div class="deck-actions">
              <!-- Primary Action -->
              <button id="share-deck-to-feed" class="btn-primary btn-large">
                <i class="ph ph-share-network"></i> ê²°íˆ¬ì¥ ë± ê³µìœ í•˜ê¸°
              </button>

              <!-- Secondary Actions -->
              <div class="deck-actions-secondary">
                <button id="save-deck-image" class="btn-secondary">
                  <i class="ph ph-download"></i> ì´ë¯¸ì§€ë¡œ ì €ì¥
                </button>
                <button id="copy-deck-image" class="btn-secondary">
                  <i class="ph ph-clipboard"></i> í´ë¦½ë³´ë“œì— ë³µì‚¬
                </button>
                <button id="clear-deck" class="btn-secondary">
                  <i class="ph ph-trash"></i> ë± ì´ˆê¸°í™”
                </button>
              </div>
            </div>
          </div>

          <!-- ìš°ì¸¡: ì˜ì›… ì„ íƒ ì˜ì—­ -->
          <div class="deck-right">
            <div class="hero-selection-header">
              <h2>ì˜ì›… ì„ íƒ</h2>
              <div class="selection-info">
                <span id="selected-count">0/5</span> ëª… ì„ íƒë¨
              </div>
            </div>

            <!-- í•„í„° (ì»´íŒ©íŠ¸ ê°€ë¡œ) -->
            <div class="filters-compact">
              <input type="text" id="search-hero" class="search-input" placeholder="ğŸ” ì˜ì›… ì´ë¦„ ê²€ìƒ‰..." />

              <select id="filter-rarity" class="filter-select">
                <option value="ì „ì²´">ë“±ê¸‰: ì „ì²´</option>
                <option value="ì „ì„¤+">ì „ì„¤+</option>
                <option value="ì „ì„¤">ì „ì„¤</option>
                <option value="í¬ê·€">í¬ê·€</option>
              </select>

              <select id="filter-type" class="filter-select">
                <option value="ì „ì²´">íƒ€ì…: ì „ì²´</option>
                <option value="ê³µê²©í˜•">ê³µê²©í˜•</option>
                <option value="ë§ˆë²•í˜•">ë§ˆë²•í˜•</option>
                <option value="ë§ŒëŠ¥í˜•">ë§ŒëŠ¥í˜•</option>
                <option value="ë°©ì–´í˜•">ë°©ì–´í˜•</option>
                <option value="ì§€ì›í˜•">ì§€ì›í˜•</option>
              </select>
            </div>

            <!-- ì˜ì›… ëª©ë¡ -->
            <div id="heroes-list"></div>

            <!-- ë± íŒ¨ì‹œë¸Œ íš¨ê³¼ ìš”ì•½ -->
            <div class="deck-passives-section">
              <h3 class="passives-title">ë± íš¨ê³¼ ìš”ì•½</h3>

              <!-- íš¨ê³¼ ìš”ì•½ ì¹´ë“œ -->
              <div class="effects-summary">
                <div class="effect-category ally-effects">
                  <div class="category-header">
                    <i class="ph ph-shield-check"></i>
                    <span>ì•„êµ° ê°•í™” íš¨ê³¼</span>
                  </div>
                  <div id="ally-effects-list" class="effects-list">
                    <div class="effects-empty">ì˜ì›…ì„ ì„ íƒí•˜ë©´ íš¨ê³¼ê°€ í‘œì‹œë©ë‹ˆë‹¤</div>
                  </div>
                </div>

                <div class="effect-category enemy-effects">
                  <div class="category-header">
                    <i class="ph ph-sword"></i>
                    <span>ì êµ° ì•½í™” íš¨ê³¼</span>
                  </div>
                  <div id="enemy-effects-list" class="effects-list">
                    <div class="effects-empty">ì˜ì›…ì„ ì„ íƒí•˜ë©´ íš¨ê³¼ê°€ í‘œì‹œë©ë‹ˆë‹¤</div>
                  </div>
                </div>
              </div>

              <!-- ìƒì„¸ íŒ¨ì‹œë¸Œ íš¨ê³¼ -->
              <div class="passives-detail-toggle">
                <button id="toggle-passives-detail" class="btn-toggle-detail">
                  <i class="ph ph-caret-down"></i>
                  <span>íŒ¨ì‹œë¸Œ ìƒì„¸ ë³´ê¸°</span>
                </button>
              </div>
              <div id="deck-passives-list" class="passives-list" style="display: none;">
                <div class="passives-empty">ì˜ì›…ì„ ì„ íƒí•˜ë©´ íŒ¨ì‹œë¸Œ íš¨ê³¼ê°€ í‘œì‹œë©ë‹ˆë‹¤</div>
              </div>
            </div>
          </div>
        </div>
        </div>

        <!-- Tab Content: ë± ê³µìœ  -->
        <div id="tab-shared" class="deck-tab-content">
          <div class="shared-decks-container">
            <div class="shared-decks-header">
              <h2>ê³µìœ ëœ ê²°íˆ¬ì¥ ë±</h2>
              <p class="shared-decks-subtitle">ë‹¤ë¥¸ í”Œë ˆì´ì–´ë“¤ì˜ ê²°íˆ¬ì¥ ë±ì„ í™•ì¸í•˜ê³  ì˜ê°ì„ ì–»ì–´ë³´ì„¸ìš”</p>
            </div>

            <div id="shared-decks-list" class="shared-decks-list">
              <!-- ê³µìœ ëœ ë±ë“¤ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
              <div class="shared-decks-empty">
                <i class="ph ph-users-three" style="font-size: 48px; opacity: 0.3;"></i>
                <p>ì•„ì§ ê³µìœ ëœ ë±ì´ ì—†ìŠµë‹ˆë‹¤</p>
                <p class="empty-subtitle">ì²« ë²ˆì§¸ë¡œ ë‚˜ë§Œì˜ ë±ì„ ê³µìœ í•´ë³´ì„¸ìš”!</p>
              </div>
            </div>
          </div>
        </div>
      </main>
    </div>

    <!-- ë± ê³µìœ  ëª¨ë‹¬ (í”¼ë“œì— ê³µìœ ) -->
    <div id="share-deck-modal" class="modal" style="display: none;">
      <div class="modal-content">
        <div class="modal-header">
          <h3>ê²°íˆ¬ì¥ ë± ê³µìœ í•˜ê¸°</h3>
          <button class="modal-close" id="close-share-deck-modal">Ã—</button>
        </div>
        <div class="modal-body">
          <form id="share-deck-form">
            <!-- ë± ë¯¸ë¦¬ë³´ê¸° -->
            <div class="deck-preview-section">
              <h4>ë± ë¯¸ë¦¬ë³´ê¸°</h4>
              <div id="deck-preview-image" class="deck-preview-placeholder">
                <i class="ph ph-image" style="font-size: 48px; opacity: 0.3;"></i>
                <p>ë± ì´ë¯¸ì§€ê°€ ìƒì„±ë©ë‹ˆë‹¤</p>
              </div>
            </div>

            <!-- ì˜ê²¬ ì…ë ¥ -->
            <div class="form-group">
              <label for="deck-comment">
                <i class="ph ph-chat-text"></i>
                ë± ì„¤ëª… ë° ì˜ê²¬
              </label>
              <textarea
                id="deck-comment"
                class="form-textarea"
                placeholder="ì´ ë±ì˜ íŠ¹ì§•ì´ë‚˜ ì‚¬ìš© íŒì„ ê³µìœ í•´ì£¼ì„¸ìš”..."
                rows="4"
                maxlength="500"
              ></textarea>
              <div class="char-counter">
                <span id="comment-char-count">0</span> / 500
              </div>
            </div>

            <!-- ì‘ì„±ì ì •ë³´ -->
            <div class="form-group">
              <label for="deck-author">
                <i class="ph ph-user"></i>
                ì‘ì„±ì
              </label>
              <input
                type="text"
                id="deck-author"
                class="form-input"
                placeholder="ë‹‰ë„¤ì„ì„ ì…ë ¥í•˜ì„¸ìš”"
                maxlength="20"
              />
            </div>

            <!-- ì œì¶œ ë²„íŠ¼ -->
            <div class="modal-actions">
              <button type="button" class="btn-secondary" id="cancel-share-deck">ì·¨ì†Œ</button>
              <button type="submit" class="btn-primary">
                <i class="ph ph-share-network"></i> ê³µìœ í•˜ê¸°
              </button>
            </div>

            <div id="share-success" class="success-message" style="display: none;">
              âœ“ ë±ì´ ì„±ê³µì ìœ¼ë¡œ ê³µìœ ë˜ì—ˆìŠµë‹ˆë‹¤!
            </div>
          </form>
        </div>
      </div>
    </div>

    <!-- ì˜ì›… ì„ íƒ ëª¨ë‹¬ -->
    <div id="hero-select-modal" class="modal" style="display: none;">
      <div class="modal-content">
        <div class="modal-header">
          <h3>ì˜ì›… ì„ íƒ</h3>
          <button class="modal-close" id="close-hero-select">Ã—</button>
        </div>
        <div class="modal-body">
          <!-- í•„í„° -->
          <div class="hero-select-filters">
            <input type="text" id="modal-search-hero" class="search-input" placeholder="ğŸ” ì˜ì›… ì´ë¦„ ê²€ìƒ‰..." />
            <select id="modal-filter-rarity" class="filter-select">
              <option value="ì „ì²´">ë“±ê¸‰: ì „ì²´</option>
              <option value="ì „ì„¤+">ì „ì„¤+</option>
              <option value="ì „ì„¤">ì „ì„¤</option>
              <option value="í¬ê·€">í¬ê·€</option>
            </select>
            <select id="modal-filter-type" class="filter-select">
              <option value="ì „ì²´">íƒ€ì…: ì „ì²´</option>
              <option value="ê³µê²©í˜•">ê³µê²©í˜•</option>
              <option value="ë§ˆë²•í˜•">ë§ˆë²•í˜•</option>
              <option value="ë§ŒëŠ¥í˜•">ë§ŒëŠ¥í˜•</option>
              <option value="ë°©ì–´í˜•">ë°©ì–´í˜•</option>
              <option value="ì§€ì›í˜•">ì§€ì›í˜•</option>
            </select>
          </div>

          <!-- ì˜ì›… ê·¸ë¦¬ë“œ -->
          <div id="modal-heroes-grid" class="hero-select-grid"></div>
        </div>
      </div>
    </div>

    <!-- Global Loading Overlay -->
    <div id="global-loading" class="loading-container" aria-hidden="true" style="display:flex;">
      <div class="spinner"></div>
      <div class="loading-text">L O A D I N G</div>
    </div>

    <script>
      let allHeroes = [];
      let selectedHeroes = {
        front: [null, null], // ê¸°ë³¸ ì§„í˜•: ì•ì¤„ 2
        back: [null, null, null], // ê¸°ë³¸ ì§„í˜•: ë’·ì¤„ 3
        pet: null // í« ìŠ¬ë¡¯
      };
      const MAX_DECK_SIZE = 5;
      let currentSelectingSlot = null; // { line: 'front'|'back'|'pet', index: number }

      // ì§„í˜• ì„¤ì •
      const formations = {
        default: { front: 2, back: 3 },
        balance: { front: 3, back: 2 },
        attack: { front: 1, back: 4 },
        defense: { front: 4, back: 1 }
      };
      let currentFormation = 'default';

      function showLoading(on) {
        const el = document.getElementById("global-loading");
        if (!el) return;
        el.style.display = on ? "flex" : "none";
      }

      // ì§„í˜•ì— ë”°ë¼ ìŠ¬ë¡¯ ìƒì„±
      function createFormationSlots() {
        const formation = formations[currentFormation];
        const frontContainer = document.getElementById('front-slots');
        const backContainer = document.getElementById('back-slots');

        // ë’·ì¤„ ìŠ¬ë¡¯ ìƒì„±
        backContainer.innerHTML = '';
        for (let i = 0; i < formation.back; i++) {
          const slot = document.createElement('div');
          slot.className = 'deck-slot back-slot';
          slot.dataset.line = 'back';
          slot.dataset.position = i;
          slot.innerHTML = `
            <div class="slot-indicator">B</div>
            <div class="slot-placeholder">+</div>
          `;

          // ìŠ¬ë¡¯ í´ë¦­ ì´ë²¤íŠ¸
          slot.addEventListener('click', () => {
            openHeroSelectModal('back', i);
          });

          backContainer.appendChild(slot);
        }

        // ì•ì¤„ ìŠ¬ë¡¯ ìƒì„±
        frontContainer.innerHTML = '';
        for (let i = 0; i < formation.front; i++) {
          const slot = document.createElement('div');
          slot.className = 'deck-slot front-slot';
          slot.dataset.line = 'front';
          slot.dataset.position = i;
          slot.innerHTML = `
            <div class="slot-indicator">F</div>
            <div class="slot-placeholder">+</div>
          `;

          // ìŠ¬ë¡¯ í´ë¦­ ì´ë²¤íŠ¸
          slot.addEventListener('click', () => {
            openHeroSelectModal('front', i);
          });

          frontContainer.appendChild(slot);
        }

        // ê¸°ì¡´ ì„ íƒëœ ì˜ì›…ì„ ìƒˆ ì§„í˜•ì— ë§ê²Œ ì¬ë°°ì¹˜
        redistributeHeroes();
        updateDeckDisplay();
      }

      // ì§„í˜• ë³€ê²½ ì‹œ ì˜ì›… ì¬ë°°ì¹˜
      function redistributeHeroes() {
        const formation = formations[currentFormation];
        const allSelected = [...selectedHeroes.front, ...selectedHeroes.back].filter(h => h);

        selectedHeroes.front = new Array(formation.front).fill(null);
        selectedHeroes.back = new Array(formation.back).fill(null);

        // ì˜ì›…ë“¤ì„ ë‹¤ì‹œ ë°°ì¹˜
        allSelected.forEach((hero, index) => {
          if (index < formation.front) {
            selectedHeroes.front[index] = hero;
          } else if (index < formation.front + formation.back) {
            selectedHeroes.back[index - formation.front] = hero;
          }
        });
      }

      // ì˜ì›… ì„ íƒ ëª¨ë‹¬ ì—´ê¸°
      function openHeroSelectModal(line, index) {
        currentSelectingSlot = { line, index };
        document.getElementById('hero-select-modal').style.display = 'flex';
        renderModalHeroes(allHeroes);
      }

      // ì˜ì›… ì„ íƒ ëª¨ë‹¬ ë‹«ê¸°
      function closeHeroSelectModal() {
        document.getElementById('hero-select-modal').style.display = 'none';
        currentSelectingSlot = null;

        // í•„í„° ì´ˆê¸°í™”
        document.getElementById('modal-search-hero').value = '';
        document.getElementById('modal-filter-rarity').value = 'ì „ì²´';
        document.getElementById('modal-filter-type').value = 'ì „ì²´';
      }

      // ëª¨ë‹¬ì—ì„œ ì˜ì›… ì„ íƒ
      function selectHeroFromModal(hero) {
        if (!currentSelectingSlot) return;

        const { line, index } = currentSelectingSlot;

        // í•´ë‹¹ ìŠ¬ë¡¯ì— ì˜ì›… ë°°ì¹˜
        selectedHeroes[line][index] = hero;

        updateDeckDisplay();
        closeHeroSelectModal();
      }

      // ëª¨ë‹¬ì— ì˜ì›… ëª©ë¡ ë Œë”ë§
      function renderModalHeroes(heroes) {
        const grid = document.getElementById('modal-heroes-grid');
        grid.innerHTML = '';

        heroes.forEach((hero) => {
          const card = document.createElement('div');
          card.className = 'hero-card';

          if (hero.group && hero.group.includes("(êµ¬)ì„¸ë¸ë‚˜ì´ì¸ ")) {
            card.classList.add("old-sevenknights");
          }

          // ì´ˆìƒ ì´ë¯¸ì§€ì™€ íƒ€ì… ë°°ì§€
          if (hero.portrait) {
            const imgWrapper = document.createElement("div");
            imgWrapper.className = "hero-portrait-wrap";
            imgWrapper.style.position = "relative";

            const img = document.createElement("img");
            img.src = hero.portrait;
            img.alt = hero.name || "ì´ë¯¸ì§€ ì—†ìŒ";
            const rarityClass = getRarityClass(hero.rarity);
            img.className = `hero-portrait rarity-${rarityClass}`;
            if (hero.hasEffect === true || hero.hasEffect === "true" || hero.hasEffect === 1) {
              img.classList.add("has-effect");
            }

            imgWrapper.appendChild(img);

            // Rarity border PNG if hasEffect
            if (hero.hasEffect) {
              const isOldSevenKnights = hero.group && hero.group.includes("(êµ¬)ì„¸ë¸ë‚˜ì´ì¸ ");
              const borderImg = document.createElement("img");
              borderImg.className = "rarity-border";
              borderImg.src = isOldSevenKnights
                ? "/images/border-legendary-oldsena.png"
                : "/images/border-legendary.png";
              borderImg.alt = "ì „ì„¤ í…Œë‘ë¦¬";
              imgWrapper.appendChild(borderImg);
            }

            if (hero.typeImage) {
              const typeBadge = document.createElement("img");
              typeBadge.src = hero.typeImage;
              typeBadge.alt = hero.type || "íƒ€ì… ë°°ì§€";
              typeBadge.className = "hero-type-badge";
              imgWrapper.appendChild(typeBadge);
            }

            card.appendChild(imgWrapper);
          }

          const name = document.createElement("div");
          name.className = "hero-name";
          name.textContent = hero.name || "ì´ë¦„ ì—†ìŒ";
          card.appendChild(name);

          if (hero.nickname) {
            const nickname = document.createElement("div");
            nickname.className = "hero-nickname";
            nickname.textContent = `${hero.nickname}`;
            card.appendChild(nickname);
          }

          // ì„ íƒ ì´ë²¤íŠ¸
          card.addEventListener("click", () => {
            selectHeroFromModal(hero);
          });

          grid.appendChild(card);
        });
      }

      // ëª¨ë‹¬ í•„í„° ì ìš©
      function applyModalFilters() {
        const searchTerm = document.getElementById('modal-search-hero').value.toLowerCase();
        const selectedRarity = document.getElementById('modal-filter-rarity').value;
        const selectedType = document.getElementById('modal-filter-type').value;

        let filtered = allHeroes.filter(hero => {
          const nameMatch = !searchTerm || hero.name.toLowerCase().includes(searchTerm);
          const rarityMatch = selectedRarity === "ì „ì²´" || selectedRarity === hero.rarity;
          const typeMatch = selectedType === "ì „ì²´" || selectedType === hero.type;
          return nameMatch && rarityMatch && typeMatch;
        });

        return filtered.sort((a, b) => a.name.localeCompare(b, "ko"));
      }

      // ì˜ì›… ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
      async function fetchHeroes() {
        showLoading(true);
        try {
          const response = await fetch("/api/heroes", { cache: 'no-store' });
          const data = await response.json();
          if (!Array.isArray(data)) {
            console.error("ì„œë²„ ì‘ë‹µ:", data);
            return;
          }
          allHeroes = data;

          // ì§„í˜• ìŠ¬ë¡¯ ìƒì„±
          createFormationSlots();

          setupModalFilters();
          setupFormationSelector();
        } catch (error) {
          console.error("ì—ëŸ¬:", error);
          alert("ì˜ì›… ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
        } finally {
          showLoading(false);
        }
      }

      // ì§„í˜• ì„ íƒê¸° ì„¤ì •
      function setupFormationSelector() {
        document.querySelectorAll('input[name="formation"]').forEach(radio => {
          radio.addEventListener('change', (e) => {
            currentFormation = e.target.value;

            // UI ì—…ë°ì´íŠ¸
            document.querySelectorAll('.formation-option').forEach(opt => opt.classList.remove('active'));
            e.target.closest('.formation-option').classList.add('active');

            // ìŠ¬ë¡¯ ì¬ìƒì„±
            createFormationSlots();
          });
        });
      }

      // ëª¨ë‹¬ í•„í„° ì´ë²¤íŠ¸ ì„¤ì •
      function setupModalFilters() {
        document.getElementById('modal-search-hero').addEventListener('input', () => {
          const filtered = applyModalFilters();
          renderModalHeroes(filtered);
        });

        document.getElementById('modal-filter-rarity').addEventListener('change', () => {
          const filtered = applyModalFilters();
          renderModalHeroes(filtered);
        });

        document.getElementById('modal-filter-type').addEventListener('change', () => {
          const filtered = applyModalFilters();
          renderModalHeroes(filtered);
        });

        // ëª¨ë‹¬ ë‹«ê¸° ë²„íŠ¼
        document.getElementById('close-hero-select').addEventListener('click', closeHeroSelectModal);

        // ëª¨ë‹¬ ë°°ê²½ í´ë¦­ ì‹œ ë‹«ê¸°
        document.getElementById('hero-select-modal').addEventListener('click', (e) => {
          if (e.target.id === 'hero-select-modal') {
            closeHeroSelectModal();
          }
        });
      }

      // ì˜ì›… ëª©ë¡ ë Œë”ë§ (ì‚¬ìš©í•˜ì§€ ì•ŠìŒ - ì œê±°ë¨)
      function renderHeroes_DEPRECATED(heroes) {
        const heroesContainer = document.getElementById("heroes-list");
        heroesContainer.innerHTML = "";

        heroes.forEach((hero) => {
          const card = document.createElement("div");
          card.className = "hero-card selectable";

          // ì´ë¯¸ ì„ íƒëœ ì˜ì›…ì¸ì§€ í™•ì¸ (front or back)
          const isSelected = [...selectedHeroes.front, ...selectedHeroes.back].some(h => h.id === hero.id);
          if (isSelected) {
            card.classList.add("selected");
          }

          if (hero.group && hero.group.includes("(êµ¬)ì„¸ë¸ë‚˜ì´ì¸ ")) {
            card.classList.add("old-sevenknights");
          }

          // ì´ˆìƒ ì´ë¯¸ì§€ì™€ íƒ€ì… ë°°ì§€
          if (hero.portrait) {
            const imgWrapper = document.createElement("div");
            imgWrapper.className = "hero-portrait-wrap";
            imgWrapper.style.position = "relative";

            const img = document.createElement("img");
            img.src = hero.portrait;
            img.alt = hero.name || "ì´ë¯¸ì§€ ì—†ìŒ";
            const rarityClass = (() => {
              switch (hero.rarity) {
                case "ì „ì„¤+": return "legendary-plus";
                case "ì „ì„¤": return "legendary";
                case "í¬ê·€": return "rare";
                case "ê³ ê¸‰": return "uncommon";
                default: return "normal";
              }
            })();
            img.className = `hero-portrait rarity-${rarityClass}`;
            if (hero.hasEffect === true || hero.hasEffect === "true" || hero.hasEffect === 1) {
              img.classList.add("has-effect");
            }
            imgWrapper.appendChild(img);

            // Rarity border PNG if hasEffect
            if (hero.hasEffect) {
              const isOldSevenKnights = hero.group && hero.group.includes("(êµ¬)ì„¸ë¸ë‚˜ì´ì¸ ");
              const borderImg = document.createElement("img");
              borderImg.className = "rarity-border";
              borderImg.src = isOldSevenKnights
                ? "/images/border-legendary-oldsena.png"
                : "/images/border-legendary.png";
              borderImg.alt = "ì „ì„¤ í…Œë‘ë¦¬";
              imgWrapper.appendChild(borderImg);
            }

            if (hero.typeImage) {
              const typeBadge = document.createElement("img");
              typeBadge.src = hero.typeImage;
              typeBadge.alt = hero.type || "íƒ€ì… ë°°ì§€";
              typeBadge.className = "hero-type-badge";
              imgWrapper.appendChild(typeBadge);
            }

            card.appendChild(imgWrapper);
          }

          const name = document.createElement("div");
          name.className = "hero-name";
          name.textContent = hero.name || "ì´ë¦„ ì—†ìŒ";
          card.appendChild(name);

          if (hero.nickname) {
            const nickname = document.createElement("div");
            nickname.className = "hero-nickname";
            nickname.textContent = `${hero.nickname}`;
            card.appendChild(nickname);
          }

          // ì„ íƒ ì´ë²¤íŠ¸
          card.addEventListener("click", () => {
            toggleHeroSelection(hero, card);
          });

          heroesContainer.appendChild(card);
        });
      }

      // ì˜ì›… ì„ íƒ/í•´ì œ
      function toggleHeroSelection(hero, cardElement) {
        const allSelected = [...selectedHeroes.front, ...selectedHeroes.back];
        const existingIndex = allSelected.findIndex(h => h.id === hero.id);

        if (existingIndex > -1) {
          // ì´ë¯¸ ì„ íƒëœ ì˜ì›… - ì œê±°
          const frontIndex = selectedHeroes.front.findIndex(h => h.id === hero.id);
          if (frontIndex > -1) {
            selectedHeroes.front.splice(frontIndex, 1);
          } else {
            const backIndex = selectedHeroes.back.findIndex(h => h.id === hero.id);
            if (backIndex > -1) {
              selectedHeroes.back.splice(backIndex, 1);
            }
          }
          cardElement.classList.remove("selected");
        } else {
          // ìƒˆë¡œìš´ ì˜ì›… ì„ íƒ
          const totalSelected = selectedHeroes.front.length + selectedHeroes.back.length;
          if (totalSelected >= MAX_DECK_SIZE) {
            alert(`ìµœëŒ€ ${MAX_DECK_SIZE}ëª…ê¹Œì§€ë§Œ ì„ íƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.`);
            return;
          }

          // í˜„ì¬ ì§„í˜•ì— ë”°ë¼ ì ì ˆí•œ ë¼ì¸ì— ì¶”ê°€
          const formation = formations[currentFormation];
          if (selectedHeroes.front.length < formation.front) {
            selectedHeroes.front.push({ ...hero, transcendence: 0 });
          } else if (selectedHeroes.back.length < formation.back) {
            selectedHeroes.back.push({ ...hero, transcendence: 0 });
          } else {
            // ë‘˜ ë‹¤ ê°€ë“ ì°¬ ê²½ìš° (ì´ë¡ ìƒ ë„ë‹¬ ë¶ˆê°€ëŠ¥)
            alert(`ë±ì´ ê°€ë“ ì°¼ìŠµë‹ˆë‹¤.`);
            return;
          }
          cardElement.classList.add("selected");
        }

        updateDeckDisplay();
        updateSelectedCount();
      }

      // ì´ˆì›” ë³„ ë Œë”ë§ í•¨ìˆ˜
      function renderTranscendenceStars(transcendence = 0) {
        let starsHTML = '<div class="transcendence-stars">';
        for (let i = 0; i < 6; i++) {
          const highlighted = i < transcendence;
          starsHTML += `<span class="star ${highlighted ? 'highlighted' : ''}">â˜…</span>`;
        }
        starsHTML += '</div>';
        return starsHTML;
      }

      // ì´ˆì›” ìƒíƒœ ìˆœí™˜ (0 â†’ 2 â†’ 6 â†’ 0)
      function cycleTranscendence(line, index) {
        let hero;
        if (line === 'front') {
          hero = selectedHeroes.front[index];
        } else if (line === 'back') {
          hero = selectedHeroes.back[index];
        } else if (line === 'pet') {
          hero = selectedHeroes.pet;
        }

        if (!hero) return;

        // ì´ˆì›” ìƒíƒœ ìˆœí™˜
        if (!hero.transcendence || hero.transcendence === 0) {
          hero.transcendence = 2;
        } else if (hero.transcendence === 2) {
          hero.transcendence = 6;
        } else {
          hero.transcendence = 0;
        }

        updateDeckDisplay();
      }

      // ë± ë””ìŠ¤í”Œë ˆì´ ì—…ë°ì´íŠ¸
      function updateDeckDisplay() {
        // ì•ì¤„ ìŠ¬ë¡¯ ì—…ë°ì´íŠ¸
        const frontSlots = document.querySelectorAll('.front-slot');
        frontSlots.forEach((slot, index) => {
          const hero = selectedHeroes.front[index];

          if (hero) {
            slot.innerHTML = `
              <div class="slot-indicator">F</div>
              <div class="slot-hero" style="position: relative;">
                <img src="${hero.portrait}" alt="${hero.name}" class="slot-hero-portrait rarity-${getRarityClass(hero.rarity)} ${hero.hasEffect ? 'has-effect' : ''}" />
                ${renderRarityBorder(hero)}
                <div class="slot-hero-name">${hero.name}</div>
                ${renderTranscendenceStars(hero.transcendence || 0)}
              </div>
            `;
          } else {
            slot.innerHTML = `
              <div class="slot-indicator">F</div>
              <div class="slot-placeholder">+</div>
            `;
          }

          // ìŠ¬ë¡¯ í´ë¦­ ì´ë²¤íŠ¸ ì¬ë¶€ì°©
          slot.replaceWith(slot.cloneNode(true));
          const newSlot = document.querySelectorAll('.front-slot')[index];

          // ìŠ¬ë¡¯ ì „ì²´ í´ë¦­ (ì˜ì›… ì œê±°/ì¶”ê°€)
          newSlot.addEventListener('click', (e) => {
            // ë³„ í´ë¦­ì´ ì•„ë‹Œ ê²½ìš°ì—ë§Œ
            if (!e.target.closest('.transcendence-stars')) {
              if (hero) {
                removeHeroFromDeck('front', index);
              } else {
                openHeroSelectModal('front', index);
              }
            }
          });

          // ë³„ í´ë¦­ ì´ë²¤íŠ¸
          if (hero) {
            const stars = newSlot.querySelector('.transcendence-stars');
            if (stars) {
              stars.addEventListener('click', (e) => {
                e.stopPropagation();
                cycleTranscendence('front', index);
              });
            }
          }
        });

        // ë’·ì¤„ ìŠ¬ë¡¯ ì—…ë°ì´íŠ¸
        const backSlots = document.querySelectorAll('.back-slot');
        backSlots.forEach((slot, index) => {
          const hero = selectedHeroes.back[index];

          if (hero) {
            slot.innerHTML = `
              <div class="slot-indicator">B</div>
              <div class="slot-hero" style="position: relative;">
                <img src="${hero.portrait}" alt="${hero.name}" class="slot-hero-portrait rarity-${getRarityClass(hero.rarity)} ${hero.hasEffect ? 'has-effect' : ''}" />
                ${renderRarityBorder(hero)}
                <div class="slot-hero-name">${hero.name}</div>
                ${renderTranscendenceStars(hero.transcendence || 0)}
              </div>
            `;
          } else {
            slot.innerHTML = `
              <div class="slot-indicator">B</div>
              <div class="slot-placeholder">+</div>
            `;
          }

          // ìŠ¬ë¡¯ í´ë¦­ ì´ë²¤íŠ¸ ì¬ë¶€ì°©
          slot.replaceWith(slot.cloneNode(true));
          const newSlot = document.querySelectorAll('.back-slot')[index];

          // ìŠ¬ë¡¯ ì „ì²´ í´ë¦­ (ì˜ì›… ì œê±°/ì¶”ê°€)
          newSlot.addEventListener('click', (e) => {
            // ë³„ í´ë¦­ì´ ì•„ë‹Œ ê²½ìš°ì—ë§Œ
            if (!e.target.closest('.transcendence-stars')) {
              if (hero) {
                removeHeroFromDeck('back', index);
              } else {
                openHeroSelectModal('back', index);
              }
            }
          });

          // ë³„ í´ë¦­ ì´ë²¤íŠ¸
          if (hero) {
            const stars = newSlot.querySelector('.transcendence-stars');
            if (stars) {
              stars.addEventListener('click', (e) => {
                e.stopPropagation();
                cycleTranscendence('back', index);
              });
            }
          }
        });

        // í« ìŠ¬ë¡¯ ì—…ë°ì´íŠ¸
        const petSlot = document.getElementById('pet-slot');
        const pet = selectedHeroes.pet;

        if (pet) {
          petSlot.innerHTML = `
            <div class="slot-indicator">P</div>
            <div class="slot-hero">
              <img src="${pet.portrait}" alt="${pet.name}" class="slot-hero-portrait" />
              <div class="slot-hero-name">${pet.name}</div>
            </div>
          `;
        } else {
          petSlot.innerHTML = `
            <div class="slot-indicator">P</div>
            <div class="slot-placeholder">+</div>
          `;
        }

        // í« ìŠ¬ë¡¯ í´ë¦­ ì´ë²¤íŠ¸
        const newPetSlot = petSlot.cloneNode(true);
        petSlot.replaceWith(newPetSlot);
        document.getElementById('pet-slot').addEventListener('click', () => {
          if (pet) {
            selectedHeroes.pet = null;
            updateDeckDisplay();
          } else {
            // TODO: í« ì„ íƒ ëª¨ë‹¬ ì—´ê¸° (í« ë°ì´í„° ì¤€ë¹„ í›„)
            alert('í« ì—ì–´í…Œì´ë¸” ì¤€ë¹„ í›„ ì¶”ê°€ ì˜ˆì •');
          }
        });

        // íŒ¨ì‹œë¸Œ íš¨ê³¼ ì—…ë°ì´íŠ¸
        updateDeckPassives();
      }

      // ë±ì—ì„œ ì˜ì›… ì œê±°
      function removeHeroFromDeck(line, index) {
        if (line === 'front') {
          selectedHeroes.front[index] = null;
        } else if (line === 'back') {
          selectedHeroes.back[index] = null;
        }
        updateDeckDisplay();
        updateDeckPassives();
      }

      // ë± íŒ¨ì‹œë¸Œ íš¨ê³¼ ì—…ë°ì´íŠ¸
      function updateDeckPassives() {
        const passivesList = document.getElementById('deck-passives-list');
        const allyEffectsList = document.getElementById('ally-effects-list');
        const enemyEffectsList = document.getElementById('enemy-effects-list');
        const allSelected = [...selectedHeroes.front, ...selectedHeroes.back].filter(h => h);

        if (allSelected.length === 0) {
          passivesList.innerHTML = '<div class="passives-empty">ì˜ì›…ì„ ì„ íƒí•˜ë©´ íŒ¨ì‹œë¸Œ íš¨ê³¼ê°€ í‘œì‹œë©ë‹ˆë‹¤</div>';
          allyEffectsList.innerHTML = '<div class="effects-empty">ì˜ì›…ì„ ì„ íƒí•˜ë©´ íš¨ê³¼ê°€ í‘œì‹œë©ë‹ˆë‹¤</div>';
          enemyEffectsList.innerHTML = '<div class="effects-empty">ì˜ì›…ì„ ì„ íƒí•˜ë©´ íš¨ê³¼ê°€ í‘œì‹œë©ë‹ˆë‹¤</div>';
          return;
        }

        let passivesHTML = '';
        const allAllyEffects = [];
        const allEnemyEffects = [];

        allSelected.forEach(hero => {
          if (!hero.skills || hero.skills.length === 0) return;

          // íŒ¨ì‹œë¸Œ ìŠ¤í‚¬ ì°¾ê¸°
          const passiveSkills = hero.skills.filter(skill =>
            skill.name && (skill.name.includes('íŒ¨ì‹œë¸Œ') || skill.type === 'íŒ¨ì‹œë¸Œ')
          );

          passiveSkills.forEach(skill => {
            const transcendenceLabel = hero.transcendence
              ? `â˜…${hero.transcendence}ì´ˆì›”`
              : 'â˜…0ì´ˆì›”';

            // ìŠ¤í‚¬ ì„¤ëª…ì—ì„œ <<íš¨ê³¼, ë³€ìˆ˜>> íŒ¨í„´ ì œê±°
            const cleanedDescription = (skill.description || '').replace(/<<[^>]+>>/g, '').trim();

            // ìƒì„¸ íŒ¨ì‹œë¸Œ ëª©ë¡
            passivesHTML += `
              <div class="passive-item">
                <div class="passive-hero-info">
                  <img src="${hero.portrait}" alt="${hero.name}" class="passive-hero-portrait" />
                  <div class="passive-hero-details">
                    <div class="passive-hero-name">${hero.name}</div>
                    <div class="passive-transcendence">${transcendenceLabel}</div>
                  </div>
                </div>
                <div class="passive-skill-name">${skill.name}</div>
                <div class="passive-skill-desc">${cleanedDescription || 'ì„¤ëª… ì—†ìŒ'}</div>
              </div>
            `;

            // âœ… ìŠ¤í‚¬ì˜ effects ë°°ì—´ì„ ìˆœíšŒí•˜ì—¬ ë¶„ë¥˜
            const effects = skill.effects || [];
            if (effects.length === 0) {
              console.warn(`âš ï¸ ${hero.name}ì˜ ${skill.name}ì— íš¨ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤`);
            }

            // ìŠ¤í‚¬ ì„¤ëª…ì—ì„œ <<íš¨ê³¼ì´ë¦„, ë³€ìˆ˜>> íŒ¨í„´ ì¶”ì¶œ
            const skillDescription = skill.description || '';
            const effectParamsMap = {};

            // <<íš¨ê³¼ì´ë¦„>> ë˜ëŠ” <<íš¨ê³¼ì´ë¦„, ë³€ìˆ˜>> íŒ¨í„´ íŒŒì‹±
            const effectPattern = /<<([^,>]+)(?:,\s*(\d+(?:\.\d+)?))?>>/g;
            let match;
            while ((match = effectPattern.exec(skillDescription)) !== null) {
              const effectName = match[1].trim();
              const paramValue = match[2] ? match[2].trim() : null;
              effectParamsMap[effectName] = paramValue;
            }

            effects.forEach(effect => {
              console.log('ğŸ“Š Effect ë°ì´í„°:', effect);
              const effectType = effect.effectType;
              const effectName = effect.name || '';
              const effectTemplate = effect.description || 'ì„¤ëª… ì—†ìŒ';
              const hasVariable = effect.hasVariable || false;

              console.log(`  - effectName: "${effectName}"`);
              console.log(`  - effectTemplate: "${effectTemplate}"`);
              console.log(`  - hasVariable: ${hasVariable}`);

              // ë³€ìˆ˜ ì²˜ë¦¬
              let finalDescription = effectTemplate;

              if (hasVariable) {
                // ë³€ìˆ˜ê°€ ìˆëŠ” íš¨ê³¼: ìŠ¤í‚¬ ì„¤ëª…ì—ì„œ ë³€ìˆ˜ê°’ì„ ê°€ì ¸ì™€ ì¹˜í™˜
                const paramValue = effectParamsMap[effectName];
                if (paramValue !== null && paramValue !== undefined) {
                  // "n"ì„ ë³€ìˆ˜ê°’ìœ¼ë¡œ ì¹˜í™˜
                  finalDescription = effectTemplate.replace(/\bn\b/g, paramValue);
                } else {
                  // ë³€ìˆ˜ê°’ì„ ì°¾ì§€ ëª»í•œ ê²½ìš° ê²½ê³ 
                  console.warn(`âš ï¸ ë³€ìˆ˜ê°€ í•„ìš”í•œ íš¨ê³¼ì´ì§€ë§Œ ê°’ì„ ì°¾ì„ ìˆ˜ ì—†ìŒ: ${hero.name} - ${skill.name} - ${effectName}`);
                }
              }
              // hasVariableì´ falseë©´ descriptionì„ ê·¸ëŒ€ë¡œ ì‚¬ìš©

              const effectData = {
                hero: hero.name,
                effectName: effectName,
                effectDescription: finalDescription,
                portrait: hero.portrait,
                transcendence: hero.transcendence || 0,
                skillName: skill.name,
                icon: effect.icon
              };

              // effectTypeì— ë”°ë¼ ë¶„ë¥˜
              if (effectType === 'buff' || effectType === 'BUFF') {
                allAllyEffects.push(effectData);
              } else if (effectType === 'debuff' || effectType === 'DEBUFF') {
                allEnemyEffects.push(effectData);
              } else if (effectType === 'mixed' || effectType === 'MIXED') {
                // í˜¼í•© íš¨ê³¼ëŠ” ì–‘ìª½ì— ëª¨ë‘ ì¶”ê°€
                allAllyEffects.push(effectData);
                allEnemyEffects.push(effectData);
              } else if (!effectType || effectType === 'neutral' || effectType === 'NEUTRAL') {
                // effectTypeì´ ì—†ê±°ë‚˜ ì¤‘ë¦½ì¸ ê²½ìš°, ë¶„ë¥˜í•˜ì§€ ì•ŠìŒ
                console.warn(`âš ï¸ effectType ë¯¸ì§€ì •: ${hero.name} - ${skill.name} - ${effect.name}`);
              } else {
                // ì˜ˆìƒì¹˜ ëª»í•œ effectTypeì¸ ê²½ìš° ê²½ê³ 
                console.warn(`âš ï¸ ì•Œ ìˆ˜ ì—†ëŠ” effectType: ${effectType} (${hero.name} - ${skill.name} - ${effect.name})`);
              }
            });
          });
        });

        // ìƒì„¸ íŒ¨ì‹œë¸Œ ëª©ë¡ ì—…ë°ì´íŠ¸
        if (passivesHTML === '') {
          passivesList.innerHTML = '<div class="passives-empty">íŒ¨ì‹œë¸Œ ìŠ¤í‚¬ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤</div>';
        } else {
          passivesList.innerHTML = passivesHTML;
        }

        // ì•„êµ° íš¨ê³¼ ëª©ë¡ ì—…ë°ì´íŠ¸
        if (allAllyEffects.length === 0) {
          allyEffectsList.innerHTML = '<div class="effects-empty">ì•„êµ° ê°•í™” íš¨ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤</div>';
        } else {
          let allyHTML = '';
          allAllyEffects.forEach(({ hero, effectName, effectDescription, portrait, transcendence, skillName, icon }) => {
            const transcLabel = transcendence ? `â˜…${transcendence}ì´ˆì›”` : 'â˜…0ì´ˆì›”';
            const iconHTML = icon ? `<img src="${icon}" alt="${effectName}" class="effect-icon" />` : '';
            allyHTML += `
              <div class="effect-item">
                <div class="effect-hero-badge">
                  <img src="${portrait}" alt="${hero}" class="effect-hero-portrait" />
                  <span class="effect-hero-name">${hero}</span>
                  <span class="effect-transcendence">${transcLabel}</span>
                </div>
                <div class="effect-name-row">
                  ${iconHTML}
                  <span class="effect-name">${effectName || skillName}</span>
                </div>
                <div class="effect-text">${effectDescription}</div>
              </div>
            `;
          });
          allyEffectsList.innerHTML = allyHTML;
        }

        // ì êµ° íš¨ê³¼ ëª©ë¡ ì—…ë°ì´íŠ¸
        if (allEnemyEffects.length === 0) {
          enemyEffectsList.innerHTML = '<div class="effects-empty">ì êµ° ì•½í™” íš¨ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤</div>';
        } else {
          let enemyHTML = '';
          allEnemyEffects.forEach(({ hero, effectName, effectDescription, portrait, transcendence, skillName, icon }) => {
            const transcLabel = transcendence ? `â˜…${transcendence}ì´ˆì›”` : 'â˜…0ì´ˆì›”';
            const iconHTML = icon ? `<img src="${icon}" alt="${effectName}" class="effect-icon" />` : '';
            enemyHTML += `
              <div class="effect-item">
                <div class="effect-hero-badge">
                  <img src="${portrait}" alt="${hero}" class="effect-hero-portrait" />
                  <span class="effect-hero-name">${hero}</span>
                  <span class="effect-transcendence">${transcLabel}</span>
                </div>
                <div class="effect-name-row">
                  ${iconHTML}
                  <span class="effect-name">${effectName || skillName}</span>
                </div>
                <div class="effect-text">${effectDescription}</div>
              </div>
            `;
          });
          enemyEffectsList.innerHTML = enemyHTML;
        }
      }

      // ë“±ê¸‰ í´ë˜ìŠ¤ ë°˜í™˜
      function getRarityClass(rarity) {
        switch (rarity) {
          case "ì „ì„¤+": return "legendary-plus";
          case "ì „ì„¤": return "legendary";
          case "í¬ê·€": return "rare";
          case "ê³ ê¸‰": return "uncommon";
          default: return "normal";
        }
      }

      // Rarity border HTML ìƒì„±
      function renderRarityBorder(hero) {
        if (!hero.hasEffect) return '';

        const isOldSevenKnights = hero.group && hero.group.includes("(êµ¬)ì„¸ë¸ë‚˜ì´ì¸ ");
        const borderImage = isOldSevenKnights
          ? "/images/border-legendary-oldsena.png"
          : "/images/border-legendary.png";

        return `<img src="${borderImage}" alt="ì „ì„¤ í…Œë‘ë¦¬" class="rarity-border">`;
      }

      // ë± ì´ˆê¸°í™”
      document.getElementById('clear-deck').addEventListener('click', () => {
        const formation = formations[currentFormation];
        const hasHeroes = selectedHeroes.front.some(h => h) || selectedHeroes.back.some(h => h);

        if (!hasHeroes) return;

        if (confirm('ë±ì„ ì´ˆê¸°í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
          selectedHeroes.front = new Array(formation.front).fill(null);
          selectedHeroes.back = new Array(formation.back).fill(null);
          updateDeckDisplay();
        }
      });

      // ë± ê³µìœ 
      // ë±ì„ ì´ë¯¸ì§€ë¡œ ìº¡ì²˜í•˜ëŠ” í•¨ìˆ˜
      async function captureDeckImage() {
        const deckDisplay = document.querySelector('.deck-display');

        try {
          const canvas = await html2canvas(deckDisplay, {
            backgroundColor: '#ffffff',
            scale: 2,
            logging: false,
            useCORS: true
          });
          return canvas;
        } catch (error) {
          console.error('ì´ë¯¸ì§€ ìƒì„± ì‹¤íŒ¨:', error);
          alert('ì´ë¯¸ì§€ ìƒì„±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
          return null;
        }
      }

      // Tab Switching
      document.querySelectorAll('.deck-tab').forEach(tab => {
        tab.addEventListener('click', () => {
          const targetTab = tab.dataset.tab;

          // Update active tab
          document.querySelectorAll('.deck-tab').forEach(t => t.classList.remove('active'));
          tab.classList.add('active');

          // Update active content
          document.querySelectorAll('.deck-tab-content').forEach(content => {
            content.classList.remove('active');
          });
          document.getElementById(`tab-${targetTab}`).classList.add('active');

          // Load shared decks if switching to shared tab
          if (targetTab === 'shared') {
            loadSharedDecks();
          }
        });
      });

      // Character counter for comment
      const commentTextarea = document.getElementById('deck-comment');
      const charCount = document.getElementById('comment-char-count');

      if (commentTextarea && charCount) {
        commentTextarea.addEventListener('input', () => {
          charCount.textContent = commentTextarea.value.length;
        });
      }

      // Share deck to feed button
      document.getElementById('share-deck-to-feed').addEventListener('click', async () => {
        const allHeroes = [...selectedHeroes.front, ...selectedHeroes.back].filter(h => h);

        if (allHeroes.length === 0) {
          alert('ê³µìœ í•  ì˜ì›…ì„ ì„ íƒí•´ì£¼ì„¸ìš”.');
          return;
        }

        // Generate deck preview
        const canvas = await captureDeckImage();
        if (!canvas) return;

        // Show preview in modal
        const previewDiv = document.getElementById('deck-preview-image');
        canvas.toBlob((blob) => {
          const url = URL.createObjectURL(blob);
          previewDiv.innerHTML = `<img src="${url}" alt="Deck Preview" />`;
        });

        // Open modal
        document.getElementById('share-deck-modal').style.display = 'flex';
      });

      // Save deck image directly
      document.getElementById('save-deck-image').addEventListener('click', async () => {
        const allHeroes = [...selectedHeroes.front, ...selectedHeroes.back].filter(h => h);

        if (allHeroes.length === 0) {
          alert('ì €ì¥í•  ì˜ì›…ì„ ì„ íƒí•´ì£¼ì„¸ìš”.');
          return;
        }

        const canvas = await captureDeckImage();
        if (!canvas) return;

        canvas.toBlob((blob) => {
          const url = URL.createObjectURL(blob);
          const a = document.createElement('a');
          a.href = url;
          a.download = `ì„¸ë‚˜DB_ë±_${new Date().getTime()}.png`;
          a.click();
          URL.revokeObjectURL(url);

          alert('âœ“ ì´ë¯¸ì§€ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!');
        });
      });

      // Copy deck image to clipboard directly
      document.getElementById('copy-deck-image').addEventListener('click', async () => {
        const allHeroes = [...selectedHeroes.front, ...selectedHeroes.back].filter(h => h);

        if (allHeroes.length === 0) {
          alert('ë³µì‚¬í•  ì˜ì›…ì„ ì„ íƒí•´ì£¼ì„¸ìš”.');
          return;
        }

        const canvas = await captureDeckImage();
        if (!canvas) return;

        try {
          canvas.toBlob(async (blob) => {
            await navigator.clipboard.write([
              new ClipboardItem({ 'image/png': blob })
            ]);

            alert('âœ“ ì´ë¯¸ì§€ê°€ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!');
          });
        } catch (error) {
          console.error('í´ë¦½ë³´ë“œ ë³µì‚¬ ì‹¤íŒ¨:', error);
          alert('í´ë¦½ë³´ë“œ ë³µì‚¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë¸Œë¼ìš°ì €ê°€ ì§€ì›í•˜ì§€ ì•Šì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
        }
      });

      // Close share deck modal
      document.getElementById('close-share-deck-modal').addEventListener('click', () => {
        document.getElementById('share-deck-modal').style.display = 'none';
        document.getElementById('deck-comment').value = '';
        document.getElementById('deck-author').value = '';
        document.getElementById('comment-char-count').textContent = '0';
        document.getElementById('share-success').style.display = 'none';
      });

      document.getElementById('cancel-share-deck').addEventListener('click', () => {
        document.getElementById('share-deck-modal').style.display = 'none';
        document.getElementById('deck-comment').value = '';
        document.getElementById('deck-author').value = '';
        document.getElementById('comment-char-count').textContent = '0';
        document.getElementById('share-success').style.display = 'none';
      });

      // Submit shared deck
      document.getElementById('share-deck-form').addEventListener('submit', async (e) => {
        e.preventDefault();

        const comment = document.getElementById('deck-comment').value.trim();
        const author = document.getElementById('deck-author').value.trim() || 'ìµëª…';

        if (!comment) {
          alert('ë± ì„¤ëª…ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
          return;
        }

        // Get deck image as base64
        const canvas = await captureDeckImage();
        if (!canvas) return;

        const imageDataUrl = canvas.toDataURL('image/png');

        // Create shared deck object
        const sharedDeck = {
          id: Date.now(),
          author: author,
          comment: comment,
          image: imageDataUrl,
          date: new Date().toISOString(),
          formation: currentFormation,
          heroes: {
            front: selectedHeroes.front.filter(h => h).map(h => ({
              name: h.name,
              transcendence: h.transcendence || 0
            })),
            back: selectedHeroes.back.filter(h => h).map(h => ({
              name: h.name,
              transcendence: h.transcendence || 0
            }))
          }
        };

        // Save to localStorage (later can be replaced with API call)
        let sharedDecks = JSON.parse(localStorage.getItem('sharedDecks') || '[]');
        sharedDecks.unshift(sharedDeck);
        localStorage.setItem('sharedDecks', JSON.stringify(sharedDecks));

        // Show success message
        const successMsg = document.getElementById('share-success');
        successMsg.style.display = 'block';

        setTimeout(() => {
          document.getElementById('share-deck-modal').style.display = 'none';
          document.getElementById('deck-comment').value = '';
          document.getElementById('deck-author').value = '';
          document.getElementById('comment-char-count').textContent = '0';
          successMsg.style.display = 'none';

          // Switch to shared tab and reload
          document.querySelectorAll('.deck-tab').forEach(t => t.classList.remove('active'));
          document.querySelector('.deck-tab[data-tab="shared"]').classList.add('active');
          document.querySelectorAll('.deck-tab-content').forEach(content => {
            content.classList.remove('active');
          });
          document.getElementById('tab-shared').classList.add('active');
          loadSharedDecks();
        }, 2000);
      });

      // Load and display shared decks
      function loadSharedDecks() {
        const sharedDecks = JSON.parse(localStorage.getItem('sharedDecks') || '[]');
        const listContainer = document.getElementById('shared-decks-list');

        if (sharedDecks.length === 0) {
          listContainer.innerHTML = `
            <div class="shared-decks-empty">
              <i class="ph ph-users-three" style="font-size: 48px; opacity: 0.3;"></i>
              <p>ì•„ì§ ê³µìœ ëœ ë±ì´ ì—†ìŠµë‹ˆë‹¤</p>
              <p class="empty-subtitle">ì²« ë²ˆì§¸ë¡œ ë‚˜ë§Œì˜ ë±ì„ ê³µìœ í•´ë³´ì„¸ìš”!</p>
            </div>
          `;
          return;
        }

        listContainer.innerHTML = sharedDecks.map(deck => {
          const date = new Date(deck.date);
          const dateStr = date.toLocaleDateString('ko-KR', {
            year: 'numeric',
            month: 'long',
            day: 'numeric'
          });

          return `
            <div class="shared-deck-card">
              <div class="shared-deck-header">
                <div class="shared-deck-author">
                  <i class="ph ph-user-circle"></i>
                  <span>${deck.author}</span>
                </div>
                <div class="shared-deck-date">${dateStr}</div>
              </div>
              <img src="${deck.image}" alt="Shared Deck" class="shared-deck-image" />
              <div class="shared-deck-comment">${deck.comment}</div>
            </div>
          `;
        }).join('');
      }

      // Modal background click to close
      document.getElementById('share-deck-modal').addEventListener('click', (e) => {
        if (e.target.id === 'share-deck-modal') {
          document.getElementById('share-deck-modal').style.display = 'none';
          document.getElementById('deck-comment').value = '';
          document.getElementById('deck-author').value = '';
          document.getElementById('comment-char-count').textContent = '0';
          document.getElementById('share-success').style.display = 'none';
        }
      });

      // íŒ¨ì‹œë¸Œ ìƒì„¸ ë³´ê¸° í† ê¸€
      document.addEventListener('DOMContentLoaded', () => {
        const toggleBtn = document.getElementById('toggle-passives-detail');
        const passivesList = document.getElementById('deck-passives-list');

        if (toggleBtn) {
          toggleBtn.addEventListener('click', () => {
            const isVisible = passivesList.style.display !== 'none';
            passivesList.style.display = isVisible ? 'none' : 'block';

            const icon = toggleBtn.querySelector('i');
            const text = toggleBtn.querySelector('span');
            if (isVisible) {
              icon.className = 'ph ph-caret-down';
              text.textContent = 'íŒ¨ì‹œë¸Œ ìƒì„¸ ë³´ê¸°';
            } else {
              icon.className = 'ph ph-caret-up';
              text.textContent = 'íŒ¨ì‹œë¸Œ ìƒì„¸ ë‹«ê¸°';
            }
          });
        }
      });

      // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
      document.addEventListener("DOMContentLoaded", () => {
        fetchHeroes();
      });
    </script>

    <script>
      // í…Œë§ˆ í† ê¸€ ê¸°ëŠ¥
      const themeToggle = document.getElementById('theme-toggle');
      const themeIcon = document.getElementById('theme-icon');
      const themeText = document.getElementById('theme-text');
      const htmlElement = document.documentElement;

      // ì €ì¥ëœ í…Œë§ˆ ë˜ëŠ” ì‹œìŠ¤í…œ ê¸°ë³¸ê°’ ê°€ì ¸ì˜¤ê¸°
      function getInitialTheme() {
        const savedTheme = localStorage.getItem('theme');
        if (savedTheme) {
          return savedTheme;
        }
        // ì‹œìŠ¤í…œ ë‹¤í¬ ëª¨ë“œ ì„¤ì • í™•ì¸
        const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
        return prefersDark ? 'dark' : 'light';
      }

      // í…Œë§ˆ ì ìš©
      function applyTheme(theme) {
        if (theme === 'light') {
          htmlElement.setAttribute('data-theme', 'light');
          themeIcon.className = 'ph-bold ph-moon';
          themeText.textContent = 'ë‹¤í¬ ëª¨ë“œ';
        } else {
          htmlElement.removeAttribute('data-theme');
          themeIcon.className = 'ph-bold ph-sun';
          themeText.textContent = 'ë¼ì´íŠ¸ ëª¨ë“œ';
        }
        localStorage.setItem('theme', theme);
      }

      // í…Œë§ˆ ì „í™˜
      function toggleTheme() {
        const currentTheme = htmlElement.getAttribute('data-theme') === 'light' ? 'light' : 'dark';
        const newTheme = currentTheme === 'light' ? 'dark' : 'light';
        applyTheme(newTheme);
      }

      // ì´ˆê¸° í…Œë§ˆ ì ìš©
      applyTheme(getInitialTheme());

      // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
      themeToggle.addEventListener('click', toggleTheme);

      // ì‹œìŠ¤í…œ í…Œë§ˆ ë³€ê²½ ê°ì§€ (ì„ íƒì‚¬í•­)
      window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', (e) => {
        if (!localStorage.getItem('theme')) {
          applyTheme(e.matches ? 'dark' : 'light');
        }
      });
    </script>

    <!-- Mobile Menu Script -->
    <script src="/js/header.js"></script>
    <script src="/js/theme.js"></script>
    <script src="/js/mobile-menu.js"></script>
  </body>
</html>
